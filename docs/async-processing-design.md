# å¼‚æ­¥å¤„ç†ç´ ææ”¯æŒè®¾è®¡æ–¹æ¡ˆ

## ğŸ“Š å½“å‰è¿›åº¦æ€»ç»“

**æ•´ä½“è¿›åº¦ï¼šPhase 1-4 å®Œæˆ âœ…ï¼ŒPhase 3.5 å®Œæˆ âœ…ï¼ŒPhase 5-7 å¾…å®ç° âŒ**

- âœ… **Phase 1: åŸºç¡€ç±»å‹æ‰©å±•** - å·²å®Œæˆæ‰€æœ‰ç±»å‹å®šä¹‰å’Œæ¥å£è®¾è®¡
- âœ… **Phase 2: åª’ä½“åº“UIæ‰©å±•** - å·²å®Œæˆ"å¤„ç†ä¸­"tabã€è¿œç¨‹ä¸‹è½½å¯¹è¯æ¡†å’Œæ ·å¼ä¿®å¤
- âœ… **Phase 3: ç½‘ç»œä¸‹è½½å¤„ç†å™¨** - å·²å®Œæˆæ ¸å¿ƒä¸‹è½½é€»è¾‘ã€ç®¡ç†å™¨å’ŒUIé›†æˆ
- âœ… **Phase 3.5: é”™è¯¯çŠ¶æ€åª’ä½“é¡¹æŒä¹…åŒ–** - å·²å®Œæˆé”™è¯¯çŠ¶æ€åª’ä½“é¡¹çš„æŒä¹…åŒ–æ”¯æŒ
- âœ… **Phase 4: å¼‚æ­¥å¤„ç†æ—¶é—´è½´ç»„ä»¶** - å·²å®Œæˆå ä½ç¬¦ç»„ä»¶å’Œæ¸²æŸ“é€»è¾‘
- ğŸŸ¡ **Phase 5: è½¬æ¢å’Œé‡å»ºæœºåˆ¶** - å·²è®¾è®¡ä¼˜åŒ–æµç¨‹ï¼Œå¾…å®ç°éšè—è½¬æ¢å’Œclipé‡å»ºé€»è¾‘
- ğŸŸ¡ **Phase 6: æŒä¹…åŒ–æ”¯æŒ** - éƒ¨åˆ†å®ç°åŸºç¡€æ¡†æ¶ï¼Œå¾…å®Œå–„ä¿å­˜/åŠ è½½é€»è¾‘
- âŒ **Phase 7: é›†æˆå’Œæµ‹è¯•** - å¾…å®ç°å®Œæ•´çš„åŠŸèƒ½é›†æˆå’Œæµ‹è¯•

**ä¸‹ä¸€æ­¥å»ºè®®ï¼šå®ç° Phase 5 çš„ä¼˜åŒ–è½¬æ¢æœºåˆ¶ï¼ˆå…³é”®ç¯èŠ‚ï¼‰**

**é‡è¦è¯´æ˜**ï¼šPhase 4 å®é™…å·²å®Œæˆï¼Œæ—¶é—´è½´å¼‚æ­¥å¤„ç†ç»„ä»¶åŠŸèƒ½å®Œæ•´ã€‚Phase 5 å·²å®Œæˆæ ¸å¿ƒæµç¨‹è®¾è®¡ï¼Œè§£å†³äº†æ—¶é—´è½´clipä¸¢å¤±çš„å…³é”®é—®é¢˜ï¼Œç°éœ€å®ç°å…·ä½“çš„éšè—è½¬æ¢å’Œclipé‡å»ºé€»è¾‘ã€‚

### ğŸ¯ Phase 2 å®Œæˆè¯¦æƒ…
**å·²å®ç°çš„æ ¸å¿ƒåŠŸèƒ½**ï¼š
- âœ… åª’ä½“åº“"å¤„ç†ä¸­"tabï¼Œæ”¯æŒå¼‚æ­¥å¤„ç†é¡¹ç›®ç®¡ç†
- âœ… è¿œç¨‹ä¸‹è½½å¯¹è¯æ¡†ï¼Œæ”¯æŒURLè¾“å…¥å’Œæ ¼å¼é€‰æ‹©
- âœ… å®Œæ•´çš„çŠ¶æ€ç®¡ç†ç³»ç»Ÿï¼ˆPinia storeï¼‰
- âœ… è¿›åº¦æ˜¾ç¤ºå’Œå–æ¶ˆåŠŸèƒ½
- âœ… æ ·å¼ç³»ç»Ÿä¿®å¤ï¼Œç¡®ä¿UIä¸€è‡´æ€§

**æŠ€æœ¯å®ç°**ï¼š
- âœ… `MediaLibrary.vue` - æ·»åŠ å¤„ç†ä¸­tabå’ŒUIé€»è¾‘
- âœ… `RemoteDownloadDialog.vue` - å®Œæ•´çš„è¿œç¨‹ä¸‹è½½å¯¹è¯æ¡†ç»„ä»¶
- âœ… `mediaStore.ts` - å¼‚æ­¥å¤„ç†çŠ¶æ€ç®¡ç†
- âœ… CSSå˜é‡ä¿®å¤ - ç»Ÿä¸€ä½¿ç”¨è®¾è®¡ç³»ç»Ÿå˜é‡

### ğŸ¯ Phase 3 å®Œæˆè¯¦æƒ…
**å·²å®ç°çš„æ ¸å¿ƒåŠŸèƒ½**ï¼š
- âœ… AsyncProcessingManager æ ¸å¿ƒç®¡ç†å™¨ï¼Œæ”¯æŒå¤„ç†å™¨æ³¨å†Œå’Œä»»åŠ¡ç®¡ç†
- âœ… RemoteDownloadProcessor ç½‘ç»œä¸‹è½½å¤„ç†å™¨ï¼Œæ”¯æŒè¿›åº¦å›è°ƒå’Œå–æ¶ˆæ“ä½œ
- âœ… å®æ—¶çŠ¶æ€åŒæ­¥æœºåˆ¶ï¼Œç¡®ä¿UIå“åº”å¼æ›´æ–°
- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œç”¨æˆ·åé¦ˆç³»ç»Ÿ
- âœ… ä¸­æ–‡æ–‡ä»¶åæ”¯æŒå’Œæ™ºèƒ½æ–‡ä»¶åæå–
- âœ… ä¼˜åŒ–çš„UIæ˜¾ç¤ºï¼ŒåŒ…æ‹¬è¿›åº¦åœ†ç¯å’ŒçŠ¶æ€æŒ‡ç¤ºå™¨

**æŠ€æœ¯å®ç°**ï¼š
- âœ… `AsyncProcessingManager.ts` - å¼‚æ­¥å¤„ç†ç®¡ç†å™¨å•ä¾‹ç±»
- âœ… `RemoteDownloadProcessor.ts` - ç½‘ç»œä¸‹è½½å¤„ç†å™¨å®ç°
- âœ… `mediaModule.ts` - æ‰©å±•æ”¯æŒå¼‚æ­¥å¤„ç†ç´ æç®¡ç†
- âœ… `MediaLibrary.vue` - é›†æˆä¸‹è½½é€»è¾‘å’ŒUIä¼˜åŒ–
- âœ… åç«¯ç½‘é€Ÿé™åˆ¶åŠŸèƒ½ - æ”¯æŒåŠ¨æ€è°ƒæ•´ä¸‹è½½é€Ÿåº¦ç”¨äºæµ‹è¯•

**UI/UXä¼˜åŒ–**ï¼š
- âœ… å¼‚æ­¥å¤„ç†é¡¹ç›®ä¸“ç”¨æ˜¾ç¤ºå¸ƒå±€ï¼ˆæ— ç¼©ç•¥å›¾ï¼Œæ˜¾ç¤ºçŠ¶æ€ï¼‰
- âœ… 40pxè¿›åº¦åœ†ç¯ï¼Œç™½è‰²ç™¾åˆ†æ¯”æ–‡å­—ï¼Œæ¸…æ™°å¯è§
- âœ… ä¸åŒçŠ¶æ€çš„å›¾æ ‡å’Œé¢œè‰²åŒºåˆ†ï¼ˆç­‰å¾…/å¤„ç†/å®Œæˆ/å¤±è´¥ï¼‰
- âœ… Tooltipæç¤ºæ˜¾ç¤ºè¯¦ç»†çŠ¶æ€ä¿¡æ¯
- âœ… å®Œç¾é€‚é…50pxç¼©ç•¥å›¾å®¹å™¨é«˜åº¦

### ğŸ¯ Phase 3.5 å®Œæˆè¯¦æƒ… - é”™è¯¯çŠ¶æ€åª’ä½“é¡¹æŒä¹…åŒ–
**å·²å®ç°çš„æ ¸å¿ƒåŠŸèƒ½**ï¼š
- âœ… æ‰©å±•LocalMediaReferenceç±»å‹å®šä¹‰ï¼Œæ”¯æŒé”™è¯¯çŠ¶æ€å­—æ®µ
- âœ… MediaLibrary.vueé”™è¯¯å¤„ç†é€»è¾‘å¢å¼ºï¼Œè‡ªåŠ¨ä¿å­˜é”™è¯¯çŠ¶æ€åª’ä½“å¼•ç”¨
- âœ… MediaManageråŠŸèƒ½æ‰©å±•ï¼Œæ”¯æŒé”™è¯¯çŠ¶æ€åª’ä½“é¡¹çš„ä¿å­˜å’Œæ¢å¤
- âœ… é¡¹ç›®ä¿å­˜/åŠ è½½å®Œæ•´æ”¯æŒé”™è¯¯çŠ¶æ€åª’ä½“é¡¹æŒä¹…åŒ–
- âœ… ä¸‰ç§é”™è¯¯ç±»å‹æ”¯æŒï¼šwebavè§£æé”™è¯¯ã€æ–‡ä»¶åŠ è½½é”™è¯¯ã€ä¸æ”¯æŒæ ¼å¼

**æŠ€æœ¯å®ç°**ï¼š
- âœ… `types/index.ts` - æ‰©å±•LocalMediaReferenceæ¥å£å’ŒMediaErrorTypeæšä¸¾
- âœ… `MediaLibrary.vue` - æ·»åŠ saveErrorMediaReferenceè¾…åŠ©å‡½æ•°å’Œé”™è¯¯å¤„ç†é€»è¾‘
- âœ… `MediaManager.ts` - æ–°å¢saveErrorMediaReferenceå’ŒrestoreErrorMediaItemæ–¹æ³•
- âœ… `MediaManager.ts` - æ‰©å±•loadAllMediaForProjectæ–¹æ³•æ”¯æŒé”™è¯¯çŠ¶æ€æ¢å¤
- âœ… é¡¹ç›®ä¿å­˜/åŠ è½½æµç¨‹ - ç¡®ä¿é”™è¯¯çŠ¶æ€åª’ä½“å¼•ç”¨çš„å®Œæ•´æŒä¹…åŒ–

**ç”¨æˆ·ä½“éªŒæ”¹è¿›**ï¼š
- âœ… å¯¼å…¥å¤±è´¥çš„åª’ä½“æ–‡ä»¶ä¸å†æ¶ˆå¤±ï¼Œä¿ç•™åœ¨ç´ æåŒºæ˜¾ç¤ºé”™è¯¯çŠ¶æ€
- âœ… é¡¹ç›®é‡æ–°æ‰“å¼€æ—¶é”™è¯¯çŠ¶æ€åª’ä½“é¡¹è¢«æ­£ç¡®æ¢å¤
- âœ… æ–‡ä»¶åŠ è½½å¤±è´¥æ—¶è‡ªåŠ¨è½¬æ¢ä¸ºé”™è¯¯çŠ¶æ€ï¼Œä¸å½±å“é¡¹ç›®ä½¿ç”¨
- âœ… ä¿ç•™åŸå§‹æ–‡ä»¶ä¿¡æ¯ï¼Œä¸ºæœªæ¥é‡è¯•åŠŸèƒ½å¥ å®šåŸºç¡€
- âœ… è¯¦ç»†é”™è¯¯ä¿¡æ¯è®°å½•ï¼Œä¾¿äºé—®é¢˜è¯Šæ–­å’Œç”¨æˆ·åé¦ˆ

**æ•°æ®å®Œæ•´æ€§ä¿éšœ**ï¼š
- âœ… é”™è¯¯çŠ¶æ€åª’ä½“é¡¹å®Œæ•´çš„å…ƒæ•°æ®ä¿å­˜ï¼ˆæ–‡ä»¶åã€å¤§å°ã€ç±»å‹ã€æ—¶é—´æˆ³ï¼‰
- âœ… é”™è¯¯ç±»å‹å’Œé”™è¯¯ä¿¡æ¯çš„è¯¦ç»†è®°å½•
- âœ… ä¸æ­£å¸¸åª’ä½“å¼•ç”¨ç»Ÿä¸€çš„ç®¡ç†æœºåˆ¶ï¼Œé¿å…æ•°æ®ä¸ä¸€è‡´
- âœ… é¡¹ç›®åŠ è½½æ—¶çš„é”™è¯¯çŠ¶æ€è‡ªåŠ¨æ£€æµ‹å’Œè½¬æ¢

**Phase 3.5 è¯¦ç»†æŠ€æœ¯å®ç°**ï¼š

1. **ç±»å‹å®šä¹‰æ‰©å±•** (`frontend/src/types/index.ts`)ï¼š
```typescript
// æ‰©å±•LocalMediaReferenceæ¥å£æ”¯æŒé”™è¯¯çŠ¶æ€
export interface LocalMediaReference extends BaseMediaReference {
  type: MediaType
  storedPath: string // æ­£å¸¸çŠ¶æ€ï¼šå®é™…å­˜å‚¨è·¯å¾„ï¼›é”™è¯¯çŠ¶æ€ï¼šç©ºå­—ç¬¦ä¸²

  // æ–°å¢ï¼šçŠ¶æ€ç®¡ç†å­—æ®µ
  status?: 'normal' | 'error'  // é»˜è®¤ä¸ºnormalï¼Œå…¼å®¹ç°æœ‰æ•°æ®

  // æ–°å¢ï¼šé”™è¯¯çŠ¶æ€ç›¸å…³å­—æ®µï¼ˆä»…å½“statusä¸ºerroræ—¶æœ‰å€¼ï¼‰
  errorType?: 'webav_parse_error' | 'file_load_error' | 'unsupported_format'
  errorMessage?: string
  errorTimestamp?: string

  // æ–°å¢ï¼šä¿ç•™åŸå§‹æ–‡ä»¶ä¿¡æ¯ç”¨äºé‡è¯•åŠŸèƒ½
  originalFile?: {
    name: string
    size: number
    type: string
    lastModified: number
  }
}

// æ–°å¢é”™è¯¯ç±»å‹æšä¸¾
export type MediaErrorType =
  | 'webav_parse_error'    // WebAVè§£æå¤±è´¥ï¼ˆå¦‚æ ¼å¼ä¸æ”¯æŒã€æ–‡ä»¶æŸåï¼‰
  | 'file_load_error'      // æ–‡ä»¶åŠ è½½å¤±è´¥ï¼ˆå¦‚æ–‡ä»¶ä¸å­˜åœ¨ã€æƒé™é—®é¢˜ï¼‰
  | 'unsupported_format'   // ä¸æ”¯æŒçš„æ–‡ä»¶æ ¼å¼
```

2. **MediaLibrary.vueé”™è¯¯å¤„ç†å¢å¼º**ï¼š
```typescript
// æ–°å¢ä¿å­˜é”™è¯¯åª’ä½“å¼•ç”¨çš„è¾…åŠ©å‡½æ•°
const saveErrorMediaReference = async (
  mediaItemId: string,
  file: File,
  mediaType: MediaType,
  errorType: MediaErrorType,
  errorMessage: string
) => {
  if (!videoStore.currentProjectId) return

  try {
    const { MediaManager } = await import('../utils/MediaManager')
    const mediaManager = MediaManager.getInstance()

    const errorReference = await mediaManager.saveErrorMediaReference(
      mediaItemId, file, videoStore.currentProjectId, mediaType, errorType, errorMessage
    )

    videoStore.addMediaReference(mediaItemId, errorReference)
    console.log(`ğŸ’¾ é”™è¯¯çŠ¶æ€åª’ä½“å¼•ç”¨å·²ä¿å­˜: ${file.name}`)
  } catch (referenceError) {
    console.warn(`ä¿å­˜é”™è¯¯çŠ¶æ€åª’ä½“å¼•ç”¨å¤±è´¥: ${file.name}`, referenceError)
  }
}

// åœ¨addVideoItemã€addImageItemã€addAudioItemçš„catchå—ä¸­è°ƒç”¨
catch (error) {
  // ... åˆ›å»ºé”™è¯¯çŠ¶æ€MediaItem ...
  videoStore.updateLocalMediaItem(errorMediaItem)

  // æ–°å¢ï¼šä¿å­˜é”™è¯¯çŠ¶æ€çš„åª’ä½“å¼•ç”¨åˆ°é¡¹ç›®
  await saveErrorMediaReference(mediaItemId, file, 'video', 'webav_parse_error', error.message)

  resolve()
}
```

3. **MediaManager.tsåŠŸèƒ½æ‰©å±•**ï¼š
```typescript
// æ–°å¢ä¿å­˜é”™è¯¯çŠ¶æ€åª’ä½“å¼•ç”¨æ–¹æ³•
async saveErrorMediaReference(
  mediaId: string,
  file: File,
  projectId: string,
  mediaType: MediaType,
  errorType: MediaErrorType,
  errorMessage: string
): Promise<LocalMediaReference> {
  const errorReference: LocalMediaReference = {
    originalFileName: file.name,
    storedPath: '', // é”™è¯¯çŠ¶æ€æ²¡æœ‰å®é™…å­˜å‚¨è·¯å¾„
    type: mediaType,
    fileSize: file.size,
    checksum: '', // é”™è¯¯çŠ¶æ€æ²¡æœ‰æ–‡ä»¶æ ¡éªŒå’Œ
    status: 'error',
    errorType,
    errorMessage,
    errorTimestamp: new Date().toISOString(),
    originalFile: {
      name: file.name,
      size: file.size,
      type: file.type,
      lastModified: file.lastModified
    }
  }
  return errorReference
}

// æ–°å¢æ¢å¤é”™è¯¯çŠ¶æ€åª’ä½“é¡¹æ–¹æ³•
private restoreErrorMediaItem(mediaId: string, reference: LocalMediaReference): LocalMediaItem {
  return {
    id: mediaId,
    name: reference.originalFileName,
    createdAt: reference.errorTimestamp || new Date().toISOString(),
    file: null as any, // é”™è¯¯çŠ¶æ€æ²¡æœ‰å®é™…æ–‡ä»¶å¯¹è±¡
    url: '', // é”™è¯¯çŠ¶æ€æ²¡æœ‰URL
    duration: 0,
    type: reference.originalFile?.type || '',
    mediaType: reference.type,
    mp4Clip: null,
    imgClip: null,
    audioClip: null,
    isReady: false,
    status: 'error'
  }
}

// æ‰©å±•loadAllMediaForProjectæ–¹æ³•æ”¯æŒé”™è¯¯çŠ¶æ€
async loadAllMediaForProject(...): Promise<LocalMediaItem[]> {
  // ... æ‰¹å¤„ç†é€»è¾‘ ...
  const batchPromises = batch.map(async ([mediaId, reference]) => {
    if (reference.status === 'error') {
      // æ¢å¤é”™è¯¯çŠ¶æ€çš„åª’ä½“é¡¹
      return this.restoreErrorMediaItem(mediaId, reference)
    } else {
      // æ­£å¸¸åŠ è½½æµç¨‹
      try {
        return await this.rebuildMediaItemFromLocal(mediaId, reference, projectId)
      } catch (error) {
        // åŠ è½½å¤±è´¥ï¼Œè½¬æ¢ä¸ºé”™è¯¯çŠ¶æ€
        const updatedReference: LocalMediaReference = {
          ...reference,
          status: 'error',
          errorType: 'file_load_error',
          errorMessage: error instanceof Error ? error.message : String(error),
          errorTimestamp: new Date().toISOString()
        }
        return this.restoreErrorMediaItem(mediaId, updatedReference)
      }
    }
  })
  // ...
}
```

4. **é¡¹ç›®ä¿å­˜/åŠ è½½æµç¨‹éªŒè¯**ï¼š
- âœ… `projectModule.ts` çš„ `saveCurrentProject` æ–¹æ³•å·²æ­£ç¡®ä¿å­˜æ‰€æœ‰åª’ä½“å¼•ç”¨
- âœ… `ProjectManager.loadProjectContent` ä½¿ç”¨ `MediaManager.loadAllMediaForProject` åŠ è½½åª’ä½“
- âœ… é”™è¯¯çŠ¶æ€åª’ä½“å¼•ç”¨ä¸æ­£å¸¸å¼•ç”¨ç»Ÿä¸€ç®¡ç†ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§

**æµ‹è¯•éªŒè¯åœºæ™¯**ï¼š
1. **å¯¼å…¥å¤±è´¥æµ‹è¯•**ï¼šå¯¼å…¥æŸåæ–‡ä»¶ â†’ æ˜¾ç¤ºé”™è¯¯çŠ¶æ€ â†’ ä¿å­˜é¡¹ç›® â†’ é‡æ–°æ‰“å¼€ â†’ éªŒè¯æ¢å¤
2. **æ–‡ä»¶ä¸¢å¤±æµ‹è¯•**ï¼šåˆ é™¤é¡¹ç›®åª’ä½“æ–‡ä»¶ â†’ é‡æ–°æ‰“å¼€é¡¹ç›® â†’ éªŒè¯è‡ªåŠ¨è½¬æ¢ä¸ºé”™è¯¯çŠ¶æ€
3. **æ··åˆçŠ¶æ€æµ‹è¯•**ï¼šæ­£å¸¸+é”™è¯¯çŠ¶æ€åª’ä½“é¡¹ â†’ ä¿å­˜/åŠ è½½ â†’ éªŒè¯çŠ¶æ€æ­£ç¡®æ¢å¤

## æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿°äº†ä¸ºè§†é¢‘ç¼–è¾‘å™¨æ·»åŠ å¼‚æ­¥å¤„ç†ç´ ææ”¯æŒçš„å®Œæ•´è®¾è®¡æ–¹æ¡ˆã€‚å¼‚æ­¥å¤„ç†ç´ æåŒ…æ‹¬è¿œç¨‹æ–‡ä»¶ä¸‹è½½ã€æœ¬åœ°å¤§æ–‡ä»¶è½¬ç ã€AIå¤„ç†ç­‰éœ€è¦é•¿æ—¶é—´å¤„ç†çš„ç´ æç±»å‹ï¼Œæ”¯æŒå ä½ç¬¦æœºåˆ¶å’Œè‡ªåŠ¨ç±»å‹è½¬æ¢ã€‚

## åŠŸèƒ½éœ€æ±‚

### æ ¸å¿ƒåŠŸèƒ½
- **è¿œç¨‹ä¸‹è½½**ï¼šé€šè¿‡URLå¯¼å…¥è¿œç¨‹åª’ä½“æ–‡ä»¶
- **æœ¬åœ°è½¬ç **ï¼šå¤§æ–‡ä»¶æ ¼å¼è½¬æ¢ã€å‹ç¼©ã€ä¼˜åŒ–ç­‰
- **AIå¤„ç†**ï¼šæ™ºèƒ½å‰ªè¾‘ã€è‡ªåŠ¨å­—å¹•ã€èƒŒæ™¯ç§»é™¤ç­‰
- **æ‰¹é‡å¤„ç†**ï¼šå¤šæ–‡ä»¶åŒæ—¶å¤„ç†
- æ”¯æŒé¢„è®¡æ—¶é•¿è®¾ç½®å’Œè¿›åº¦æ˜¾ç¤º
- å¤„ç†å®Œæˆåè‡ªåŠ¨è½¬æ¢ä¸ºå¯¹åº”çš„æœ¬åœ°åª’ä½“ç±»å‹
- æ—¶é—´è½´å ä½ç¬¦æ”¯æŒï¼Œå¤„ç†æœŸé—´é™åˆ¶ç¼–è¾‘åŠŸèƒ½
- é¡¹ç›®æŒä¹…åŒ–æ—¶ä¿å­˜å¤„ç†çŠ¶æ€å’Œæ¢å¤æœºåˆ¶

### å¼‚æ­¥å¤„ç†ç±»å‹ï¼ˆå½“å‰å®ç°ï¼‰
1. **è¿œç¨‹ä¸‹è½½**ï¼šä»URLä¸‹è½½è¿œç¨‹åª’ä½“æ–‡ä»¶

### å¼‚æ­¥å¤„ç†ç±»å‹ï¼ˆæœªæ¥æ‰©å±•ï¼‰
2. **æ ¼å¼è½¬ç **ï¼šå°†ä¸æ”¯æŒçš„æ ¼å¼è½¬æ¢ä¸ºæ”¯æŒçš„æ ¼å¼ï¼ˆå¦‚AVIâ†’MP4ï¼‰
3. **æ–‡ä»¶å‹ç¼©**ï¼šå¤§æ–‡ä»¶è‡ªåŠ¨å‹ç¼©ä¼˜åŒ–
4. **AIå¢å¼º**ï¼šè§†é¢‘è¶…åˆ†è¾¨ç‡ã€é™å™ªã€ç¨³å®šç­‰
5. **å†…å®¹ç”Ÿæˆ**ï¼šAIç”ŸæˆèƒŒæ™¯éŸ³ä¹ã€å­—å¹•ã€ç‰¹æ•ˆç­‰
6. **æ‰¹é‡å¯¼å…¥**ï¼šå¤§é‡æ–‡ä»¶çš„æ‰¹é‡å¤„ç†å’Œå¯¼å…¥

### ç”¨æˆ·äº¤äº’æµç¨‹
1. é€‰æ‹©å¤„ç†ç±»å‹ â†’ æ˜¾ç¤ºå¯¹åº”çš„è¾“å…¥ç•Œé¢
2. é…ç½®å¤„ç†å‚æ•° â†’ ç¡®è®¤å¼€å§‹å¤„ç†
3. å¼‚æ­¥å¤„ç†tabæ˜¾ç¤ºè¿›åº¦ â†’ å¯æ‹–æ‹½åˆ°æ—¶é—´è½´å ä½
4. å¤„ç†å®Œæˆ â†’ è‡ªåŠ¨è½¬æ¢ä¸ºå¯¹åº”ç±»å‹å¹¶ç§»åŠ¨åˆ°ç›¸åº”tab
5. æ—¶é—´è½´clipè‡ªåŠ¨é‡å»ºä¸ºæ­£ç¡®ç±»å‹

## æŠ€æœ¯è®¾è®¡

### 1. æ•°æ®ç»“æ„æ‰©å±•

#### 1.1 ç±»å‹å®šä¹‰æ‰©å±•
```typescript
// types/index.ts

// æ ¸å¿ƒMediaTypeç±»å‹å®šä¹‰
export type MediaType = 'video' | 'image' | 'audio' | 'text'

// å¼‚æ­¥å¤„ç†ç´ æåœ¨å¤„ç†å‰ä½¿ç”¨ 'unknown' ç±»å‹ï¼Œå¤„ç†åä½¿ç”¨å®é™…æ£€æµ‹åˆ°çš„ç±»å‹
export type MediaTypeOrUnknown = MediaType | 'unknown'

// å¼‚æ­¥å¤„ç†ç´ æçŠ¶æ€æšä¸¾
export type AsyncProcessingStatus = 'pending' | 'processing' | 'completed' | 'error' | 'cancelled' | 'unsupported'

// å¼‚æ­¥å¤„ç†ç±»å‹æšä¸¾ï¼ˆå½“å‰åªæ”¯æŒè¿œç¨‹ä¸‹è½½ï¼‰
export type AsyncProcessingType = 'remote-download'

// åŸºç¡€æ—¶é—´èŒƒå›´æ¥å£ - æ‰€æœ‰æ—¶é—´èŒƒå›´çš„å…±åŒåŸºç¡€
export interface BaseTimeRange {
  /** æ—¶é—´è½´å¼€å§‹æ—¶é—´ï¼ˆå¸§æ•°ï¼‰ - åœ¨æ•´ä¸ªé¡¹ç›®æ—¶é—´è½´ä¸Šçš„å¼€å§‹ä½ç½® */
  timelineStartTime: number
  /** æ—¶é—´è½´ç»“æŸæ—¶é—´ï¼ˆå¸§æ•°ï¼‰ - åœ¨æ•´ä¸ªé¡¹ç›®æ—¶é—´è½´ä¸Šçš„ç»“æŸä½ç½® */
  timelineEndTime: number
}

// å¼‚æ­¥å¤„ç†æ—¶é—´è½´é¡¹ç›®ä¸“ç”¨æ—¶é—´èŒƒå›´æ¥å£ - ç»§æ‰¿åŸºç¡€æ—¶é—´èŒƒå›´
export interface AsyncProcessingTimeRange extends BaseTimeRange {
  // ç»§æ‰¿ timelineStartTime å’Œ timelineEndTime
  // å¯ä»¥åœ¨æœªæ¥æ·»åŠ å¼‚æ­¥å¤„ç†ç‰¹æœ‰çš„æ—¶é—´èŒƒå›´å±æ€§
}

/**
 * æ—¶é—´èŒƒå›´ç»§æ‰¿å…³ç³»è®¾è®¡è¯´æ˜ï¼š
 *
 * BaseTimeRange (åŸºç¡€æ—¶é—´èŒƒå›´)
 *   â”œâ”€â”€ AsyncProcessingTimeRange (å¼‚æ­¥å¤„ç†æ—¶é—´èŒƒå›´)
 *   â”œâ”€â”€ VideoTimeRange (è§†é¢‘æ—¶é—´èŒƒå›´) - æ‰©å±•äº† clipStartTime, clipEndTime ç­‰
 *   â””â”€â”€ ImageTimeRange (å›¾ç‰‡æ—¶é—´èŒƒå›´) - æ‰©å±•äº† displayDuration ç­‰
 *
 * è¿™ç§è®¾è®¡çš„ä¼˜åŠ¿ï¼š
 * 1. ç»Ÿä¸€çš„åŸºç¡€æ¥å£ï¼šæ‰€æœ‰æ—¶é—´èŒƒå›´éƒ½æœ‰ timelineStartTime å’Œ timelineEndTime
 * 2. ç±»å‹å®‰å…¨ï¼šå¯ä»¥åœ¨éœ€è¦åŸºç¡€æ—¶é—´èŒƒå›´çš„åœ°æ–¹ä½¿ç”¨ BaseTimeRange
 * 3. æ‰©å±•æ€§ï¼šå„ç§å…·ä½“çš„æ—¶é—´èŒƒå›´å¯ä»¥æ·»åŠ è‡ªå·±ç‰¹æœ‰çš„å±æ€§
 * 4. è½¬æ¢ä¾¿åˆ©ï¼šå¼‚æ­¥å¤„ç†æ—¶é—´èŒƒå›´å¯ä»¥æ–¹ä¾¿åœ°è½¬æ¢ä¸ºå…¶ä»–å…·ä½“ç±»å‹
 */
```

#### 1.2 ç»§æ‰¿å…³ç³»è®¾è®¡

```typescript
/**
 * åŸºç¡€åª’ä½“é¡¹ç›®æ¥å£ - æ‰€æœ‰åª’ä½“é¡¹ç›®çš„å…±åŒåŸºç¡€
 */
export interface BaseMediaItem {
  id: string
  name: string
  createdAt: string
}

/**
 * æœ¬åœ°åª’ä½“é¡¹ç›®æ¥å£ - ç»§æ‰¿åŸºç¡€æ¥å£ï¼Œæ·»åŠ æœ¬åœ°æ–‡ä»¶ç›¸å…³å±æ€§
 */
export interface LocalMediaItem extends BaseMediaItem {
  mediaType: MediaType
  file: File
  url: string
  duration: number // ç´ ææ—¶é•¿ï¼ˆå¸§æ•°ï¼‰
  type: string
  mp4Clip: Raw<MP4Clip> | null
  imgClip: Raw<ImgClip> | null
  audioClip: Raw<AudioClip> | null
  isReady: boolean
  status: MediaStatus
  thumbnailUrl?: string
  isAsyncProcessing?: false // æ˜ç¡®æ ‡è¯†ä¸ºæœ¬åœ°åª’ä½“
}

/**
 * å¼‚æ­¥å¤„ç†åª’ä½“é¡¹ç›®æ¥å£ - ç»§æ‰¿åŸºç¡€æ¥å£ï¼Œæ·»åŠ å¼‚æ­¥å¤„ç†ç›¸å…³å±æ€§
 */
export interface AsyncProcessingMediaItem extends BaseMediaItem {
  mediaType: MediaTypeOrUnknown // å¤„ç†å‰ä¸º'unknown'ï¼Œå¤„ç†åä¸ºå®é™…ç±»å‹
  isAsyncProcessing: true // æ ‡è¯†ä¸ºå¼‚æ­¥å¤„ç†åª’ä½“
  processingType: AsyncProcessingType // å¤„ç†ç±»å‹
  processingStatus: AsyncProcessingStatus // å¤„ç†çŠ¶æ€
  processingProgress: number // å¤„ç†è¿›åº¦ 0-100
  expectedDuration: number // ç”¨æˆ·è¾“å…¥çš„é¢„è®¡æ—¶é•¿ï¼ˆå¸§æ•°ï¼‰

  // å¤„ç†é…ç½®å’Œå‚æ•°
  processingConfig: AsyncProcessingConfig // å¤„ç†é…ç½®ï¼ˆæ ¹æ®ç±»å‹ä¸åŒï¼‰

  // å¤„ç†è¿‡ç¨‹ä¸­çš„ä¸´æ—¶æ•°æ®
  processedFile?: File // å¤„ç†å®Œæˆçš„æ–‡ä»¶å¯¹è±¡
  errorMessage?: string // é”™è¯¯ä¿¡æ¯

  // UIæ˜¾ç¤ºç›¸å…³
  thumbnailUrl?: string // é»˜è®¤å›¾æ ‡æˆ–é¢„è§ˆå›¾

  // æ—¶é—´æˆ³
  startedAt?: string // å¼€å§‹å¤„ç†æ—¶é—´
  completedAt?: string // å®Œæˆå¤„ç†æ—¶é—´

  // è½¬æ¢çŠ¶æ€æ ‡è®°
  isConverting: boolean // è½¬æ¢ä¸­æ ‡è®°ï¼ŒUIå±‚é¢éšè—æ˜¾ç¤ºï¼ˆå¿…é¡»å­—æ®µï¼‰
}
```

#### 1.3 å¼‚æ­¥å¤„ç†é…ç½®ç±»å‹

```typescript
/**
 * å¼‚æ­¥å¤„ç†é…ç½®è”åˆç±»å‹ï¼ˆå½“å‰åªæ”¯æŒè¿œç¨‹ä¸‹è½½ï¼‰
 */
export type AsyncProcessingConfig = RemoteDownloadConfig

/**
 * è¿œç¨‹ä¸‹è½½é…ç½®
 */
export interface RemoteDownloadConfig {
  type: 'remote-download'
  url: string // è¿œç¨‹URL
  headers?: Record<string, string> // è‡ªå®šä¹‰è¯·æ±‚å¤´
  timeout?: number // è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
}

```

#### 1.4 æ—¶é—´è½´é¡¹ç›®ç±»å‹ï¼ˆæ¿€è¿›é‡æ„åï¼‰

```typescript
/**
 * åŸºç¡€æ—¶é—´è½´é¡¹ç›®æ¥å£ - æ‰€æœ‰æ—¶é—´è½´é¡¹ç›®çš„å…±åŒåŸºç¡€
 */
export interface BaseTimelineItem {
  id: string
  mediaItemId: string
  trackId: string
  mediaType: MediaTypeOrUnknown
}

/**
 * æœ¬åœ°æ—¶é—´è½´é¡¹ç›®æ•°æ®æ¥å£ï¼ˆæŒä¹…åŒ–æ•°æ®ï¼‰
 * ç»§æ‰¿åŸºç¡€å±æ€§ï¼Œæ·»åŠ æœ¬åœ°æ—¶é—´è½´é¡¹ç›®çš„æŒä¹…åŒ–æ•°æ®
 */
export interface LocalTimelineItemData<T extends MediaType = MediaType> extends BaseTimelineItem {
  mediaType: T
  timeRange: T extends 'video'
    ? VideoTimeRange
    : T extends 'audio'
      ? VideoTimeRange
      : ImageTimeRange
  config: GetMediaConfig<T>
  animation?: AnimationConfig<T>
  mediaName: string
}

/**
 * æœ¬åœ°æ—¶é—´è½´é¡¹ç›®æ¥å£ - ç»§æ‰¿ LocalTimelineItemDataï¼Œæ·»åŠ è¿è¡Œæ—¶å±æ€§
 */
export interface LocalTimelineItem<T extends MediaType = MediaType> extends LocalTimelineItemData<T> {
  sprite: Raw<CustomSprite>
  thumbnailUrl?: string
  isAsyncProcessingPlaceholder?: false
}

/**
 * å¼‚æ­¥å¤„ç†æ—¶é—´è½´é¡¹ç›®æ¥å£ - ç»§æ‰¿åŸºç¡€æ¥å£ï¼Œæ·»åŠ å¼‚æ­¥å¤„ç†ç›¸å…³å±æ€§
 */
export interface AsyncProcessingTimelineItem extends BaseTimelineItem {
  mediaType: MediaTypeOrUnknown // å¤„ç†å‰ä¸º'unknown'ï¼Œå¤„ç†åä¸ºå®é™…ç±»å‹
  mediaItemId: string // æŒ‡å‘ AsyncProcessingMediaItem.id

  // æ—¶é—´èŒƒå›´ - ä½¿ç”¨åŸºç¡€æ—¶é—´èŒƒå›´æ¥å£
  timeRange: AsyncProcessingTimeRange

  // å¼‚æ­¥å¤„ç†çŠ¶æ€ç›¸å…³
  processingType: AsyncProcessingType
  processingStatus: AsyncProcessingStatus
  processingProgress: number // 0-100
  errorMessage?: string

  // å ä½ç¬¦é…ç½®
  config: {
    name: string // æ˜¾ç¤ºåç§°
    expectedDuration: number // é¢„è®¡æ—¶é•¿ï¼ˆå¸§æ•°ï¼‰
  }

  // æ ‡è¯†å­—æ®µ
  isAsyncProcessingPlaceholder: true
  sprite: null // å¼‚æ­¥å¤„ç†å ä½ç¬¦ä¸åˆ›å»ºsprite
}

/**
 * ç±»å‹å®ˆå«å‡½æ•°ï¼ˆæ¿€è¿›é‡æ„åç›´æ¥ä½¿ç”¨è”åˆç±»å‹ï¼‰
 */
export function isLocalTimelineItem(item: LocalTimelineItem<MediaType> | AsyncProcessingTimelineItem): item is LocalTimelineItem<MediaType> {
  return !('isAsyncProcessingPlaceholder' in item) || item.isAsyncProcessingPlaceholder === false
}

export function isAsyncProcessingTimelineItem(item: LocalTimelineItem<MediaType> | AsyncProcessingTimelineItem): item is AsyncProcessingTimelineItem {
  return 'isAsyncProcessingPlaceholder' in item && item.isAsyncProcessingPlaceholder === true
}
```

#### 1.5 æ¿€è¿›é‡æ„è¯´æ˜

**é‡æ„ç­–ç•¥**ï¼šé‡‡ç”¨æ¿€è¿›é‡æ„æ–¹å¼ï¼Œåˆ é™¤æ‰€æœ‰æ—§çš„ç±»å‹åˆ«åï¼Œå¼ºåˆ¶ä½¿ç”¨æ–°çš„å‘½åçº¦å®šã€‚

**åˆ é™¤çš„ç±»å‹åˆ«å**ï¼š
- ~~`TimelineItem<T> = LocalTimelineItem<T>`~~ âŒ
- ~~`TimelineItemData<T> = LocalTimelineItemData<T>`~~ âŒ

**æœ€ç»ˆçš„ç±»å‹æ¶æ„**ï¼š
```typescript
BaseTimelineItem
  â†“ extends
LocalTimelineItemData<T>
  â†“ extends
LocalTimelineItem<T>

// ç‹¬ç«‹çš„å¼‚æ­¥å¤„ç†æ¥å£
AsyncProcessingTimelineItem extends BaseTimelineItem
```

**é‡æ„ä¼˜åŠ¿**ï¼š
- æ²¡æœ‰å†å²åŒ…è¢±ï¼Œç±»å‹ç³»ç»Ÿæ›´åŠ æ¸…æ™°
- å¼ºåˆ¶ä½¿ç”¨æ–°çš„å‘½åçº¦å®šï¼ˆLocal* å‰ç¼€ï¼‰
- ä¸ºå¼‚æ­¥å¤„ç†åŠŸèƒ½æä¾›æ¸…æ™°çš„æ¶æ„
- ç›´æ¥ä½¿ç”¨è”åˆç±»å‹ï¼Œé¿å…é¢å¤–çš„æŠ½è±¡å±‚

### 2. UI å±‚æ”¹é€ 

#### 2.1 Tab ç³»ç»Ÿæ‰©å±•
åœ¨ `MediaLibrary.vue` ä¸­æ·»åŠ å¼‚æ­¥å¤„ç†tabï¼š

```typescript
const tabs = [
  // ... ç°æœ‰tabs
  {
    type: 'processing' as TabType,
    label: 'å¤„ç†ä¸­',
    icon: 'M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z' // åŠ è½½å›¾æ ‡
  }
]

type TabType = 'all' | 'video' | 'audio' | 'processing'
```

#### 2.2 å¯¼å…¥èœå•æ‰©å±•
æ‰©å±•å³é”®èœå•æ”¯æŒå¤šç§å¤„ç†æ–¹å¼ï¼š

```typescript
const currentMenuItems = computed((): MenuItem[] => {
  if (contextMenuType.value === 'empty') {
    return [
      {
        label: 'å¯¼å…¥æœ¬åœ°æ–‡ä»¶',
        icon: 'M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z',
        onClick: () => handleImportLocalFiles(),
      },
      {
        label: 'å¼‚æ­¥å¤„ç†',
        icon: 'M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z',
        children: [
          {
            label: 'è¿œç¨‹ä¸‹è½½',
            icon: 'M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,19.93C7.05,19.44 4,16.08 4,12C4,11.38 4.08,10.78 4.21,10.21L9,15V16A1,1 0 0,0 10,17H11V19.93M17.9,17.39C17.64,16.58 16.9,16 16,16H15V13A1,1 0 0,0 14,12H8V10H10A1,1 0 0,0 11,9V7H13A2,2 0 0,0 15,5V4.59C17.93,5.77 20,8.64 20,12C20,14.08 19.2,15.97 17.9,17.39Z',
            onClick: () => handleRemoteDownload(),
          },
          {
            label: 'æ ¼å¼è½¬æ¢',
            icon: 'M12,2A2,2 0 0,1 14,4C14,4.74 13.6,5.39 13,5.73V7.27C13.6,7.61 14,8.26 14,9A2,2 0 0,1 12,11A2,2 0 0,1 10,9C10,8.26 10.4,7.61 11,7.27V5.73C10.4,5.39 10,4.74 10,4A2,2 0 0,1 12,2Z',
            onClick: () => handleFormatConversion(),
          },
          {
            label: 'AIå¢å¼º',
            icon: 'M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,6A6,6 0 0,0 6,12A6,6 0 0,0 12,18A6,6 0 0,0 18,12A6,6 0 0,0 12,6Z',
            onClick: () => handleAIEnhancement(),
          },
          {
            label: 'æ‰¹é‡å¯¼å…¥',
            icon: 'M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z',
            onClick: () => handleBatchImport(),
          }
        ]
      }
    ]
  }
  // ... å…¶ä»–èœå•é€»è¾‘
})
```

#### 2.3 å¼‚æ­¥å¤„ç†é…ç½®å¯¹è¯æ¡†
åˆ›å»ºæ–°ç»„ä»¶ `AsyncProcessingDialog.vue`ï¼š
- **è¿œç¨‹ä¸‹è½½**ï¼šURLè¾“å…¥æ¡†ã€è¯·æ±‚å¤´é…ç½®ã€è¶…æ—¶è®¾ç½®
- **æ ¼å¼è½¬æ¢**ï¼šæ–‡ä»¶é€‰æ‹©ã€ç›®æ ‡æ ¼å¼ã€è´¨é‡è®¾ç½®ã€åˆ†è¾¨ç‡é…ç½®
- **æ–‡ä»¶å‹ç¼©**ï¼šæ–‡ä»¶é€‰æ‹©ã€å‹ç¼©çº§åˆ«ã€æœ€å¤§æ–‡ä»¶å¤§å°
- **AIå¢å¼º**ï¼šæ–‡ä»¶é€‰æ‹©ã€å¢å¼ºç±»å‹ï¼ˆè¶…åˆ†è¾¨ç‡/é™å™ª/ç¨³å®š/ä¸Šè‰²ï¼‰ã€å‚æ•°é…ç½®
- **å†…å®¹ç”Ÿæˆ**ï¼šç”Ÿæˆç±»å‹ã€æç¤ºè¯ã€æ—¶é•¿è®¾ç½®
- **æ‰¹é‡å¯¼å…¥**ï¼šæ–‡ä»¶åˆ—è¡¨ã€å¤„ç†é€‰é¡¹ï¼ˆè‡ªåŠ¨å‹ç¼©/è½¬æ¢/ç”Ÿæˆç¼©ç•¥å›¾ï¼‰
- é¢„è®¡æ—¶é•¿è¾“å…¥æ¡†ï¼ˆé»˜è®¤5ç§’ï¼Œè‡ªåŠ¨è½¬æ¢ä¸ºå¸§æ•°ï¼‰
- ç´ æåç§°è¾“å…¥æ¡†ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä»é…ç½®æå–ï¼‰
- æ”¯æŒæ ¼å¼æç¤ºå’Œå‚æ•°éªŒè¯
- ç¡®è®¤/å–æ¶ˆæŒ‰é’®

### 3. TimelineAsyncProcessingClip ç»„ä»¶è®¾è®¡

#### 3.1 ç»„ä»¶ç‰¹æ€§
- ä¸“é—¨ç”¨äºæ¸²æŸ“ AsyncProcessingTimelineItem
- æ ¹æ® processingStatus å’Œ processingType æ˜¾ç¤ºä¸åŒçš„è§†è§‰çŠ¶æ€
- æ”¯æŒåŸºæœ¬æ“ä½œï¼šé€‰ä¸­ã€åˆ é™¤ã€æ‹–æ‹½ç§»åŠ¨
- ç¦ç”¨ç¼–è¾‘åŠŸèƒ½ï¼šè£å‰ªã€å¤åˆ¶ã€åˆ†å‰²ã€åŠ¨ç”»ç­‰
- å®æ—¶æ˜¾ç¤ºå¤„ç†è¿›åº¦ã€å¤„ç†ç±»å‹å›¾æ ‡å’Œé”™è¯¯çŠ¶æ€

#### 3.2 è§†è§‰çŠ¶æ€è®¾è®¡
```scss
.timeline-async-processing-clip {
  // çŠ¶æ€æ ·å¼
  &.status-processing {
    .clip-background {
      background: linear-gradient(135deg, #3498db, #2980b9);
      border: 2px solid #2980b9;
    }
  }

  &.status-pending {
    .clip-background {
      background: linear-gradient(135deg, #f39c12, #e67e22);
      border: 2px solid #e67e22;
    }
  }

  &.status-unsupported,
  &.status-error {
    .clip-background {
      background: linear-gradient(135deg, #e74c3c, #c0392b);
      border: 2px solid #c0392b;
    }
  }

  &.status-completed {
    .clip-background {
      background: linear-gradient(135deg, #27ae60, #229954);
      border: 2px solid #229954;
    }
  }

  // å¤„ç†ç±»å‹æ ·å¼
  &.type-remote-download .processing-icon { color: #3498db; }
  &.type-format-conversion .processing-icon { color: #9b59b6; }
  &.type-file-compression .processing-icon { color: #e67e22; }
  &.type-ai-enhancement .processing-icon { color: #e74c3c; }
  &.type-content-generation .processing-icon { color: #1abc9c; }
  &.type-batch-import .processing-icon { color: #34495e; }
}
```

### 4. å¼‚æ­¥å¤„ç†ç´ æç®¡ç†å™¨

#### 4.1 AsyncProcessingManager æ ¸å¿ƒç±»
```typescript
/**
 * å¼‚æ­¥å¤„ç†å™¨æ¥å£ - æ‰€æœ‰å¤„ç†å™¨çš„åŸºç¡€æ¥å£
 */
export interface AsyncProcessor {
  readonly type: AsyncProcessingType

  /**
   * å¼€å§‹å¤„ç†
   * @param config å¤„ç†é…ç½®
   * @param onProgress è¿›åº¦å›è°ƒ
   * @returns å¤„ç†ç»“æœ
   */
  process(
    config: AsyncProcessingConfig,
    onProgress: (progress: number) => void
  ): Promise<File>

  /**
   * å–æ¶ˆå¤„ç†
   */
  cancel(): void

  /**
   * éªŒè¯é…ç½®
   * @param config å¤„ç†é…ç½®
   * @returns æ˜¯å¦æœ‰æ•ˆ
   */
  validateConfig(config: AsyncProcessingConfig): boolean
}

export class AsyncProcessingManager {
  private static instance: AsyncProcessingManager
  private processingTasks = new Map<string, AbortController>()
  private asyncProcessingMediaItems = new Map<string, AsyncProcessingMediaItem>()
  private processors = new Map<AsyncProcessingType, AsyncProcessor>()

  constructor() {
    // æ³¨å†Œé»˜è®¤å¤„ç†å™¨
    this.registerProcessor(new RemoteDownloadProcessor())
    this.registerProcessor(new FormatConversionProcessor())
    this.registerProcessor(new FileCompressionProcessor())
    this.registerProcessor(new AIEnhancementProcessor())
    this.registerProcessor(new ContentGenerationProcessor())
    this.registerProcessor(new BatchImportProcessor())
  }

  /**
   * æ³¨å†Œå¤„ç†å™¨
   * @param processor å¤„ç†å™¨å®ä¾‹
   */
  registerProcessor(processor: AsyncProcessor): void {
    this.processors.set(processor.type, processor)
  }

  /**
   * åˆ›å»ºå¼‚æ­¥å¤„ç†ç´ æé¡¹ç›®
   * @param processingType å¤„ç†ç±»å‹
   * @param config å¤„ç†é…ç½®
   * @param expectedDuration é¢„è®¡æ—¶é•¿ï¼ˆå¸§æ•°ï¼‰
   * @param name ç´ æåç§°
   * @returns å¼‚æ­¥å¤„ç†ç´ æé¡¹ç›®
   */
  createAsyncProcessingMediaItem(
    processingType: AsyncProcessingType,
    config: AsyncProcessingConfig,
    expectedDuration: number,
    name?: string
  ): AsyncProcessingMediaItem

  /**
   * å¼€å§‹å¼‚æ­¥å¤„ç†
   * @param asyncProcessingMediaItem å¼‚æ­¥å¤„ç†ç´ æé¡¹ç›®
   * @returns Promise<void>
   */
  async startProcessing(asyncProcessingMediaItem: AsyncProcessingMediaItem): Promise<void>

  /**
   * å–æ¶ˆå¼‚æ­¥å¤„ç†
   * @param mediaItemId åª’ä½“é¡¹ç›®ID
   */
  cancelProcessing(mediaItemId: string): void
}
```

#### 4.2 è¿œç¨‹ä¸‹è½½å¤„ç†å™¨å®ç°ç¤ºä¾‹
```typescript
export class RemoteDownloadProcessor implements AsyncProcessor {
  readonly type: AsyncProcessingType = 'remote-download'
  private abortController?: AbortController

  async process(
    config: AsyncProcessingConfig,
    onProgress: (progress: number) => void
  ): Promise<File> {
    if (config.type !== 'remote-download') {
      throw new Error('Invalid config type for RemoteDownloadProcessor')
    }

    const downloadConfig = config as RemoteDownloadConfig
    this.abortController = new AbortController()

    try {
      const response = await fetch(downloadConfig.url, {
        signal: this.abortController.signal,
        headers: downloadConfig.headers || {}
      })

      if (!response.ok) {
        throw new Error(`HTTP ${response.status}: ${response.statusText}`)
      }

      const contentLength = response.headers.get('content-length')
      const total = contentLength ? parseInt(contentLength, 10) : 0
      let loaded = 0

      const reader = response.body?.getReader()
      if (!reader) {
        throw new Error('Failed to get response reader')
      }

      const chunks: Uint8Array[] = []

      while (true) {
        const { done, value } = await reader.read()

        if (done) break

        chunks.push(value)
        loaded += value.length

        if (total > 0) {
          onProgress(Math.round((loaded / total) * 100))
        }
      }

      // åˆå¹¶æ‰€æœ‰chunks
      const blob = new Blob(chunks)
      const fileName = this.extractFileNameFromUrl(downloadConfig.url)

      return new File([blob], fileName, { type: blob.type })

    } catch (error) {
      if (error.name === 'AbortError') {
        throw new Error('Download cancelled')
      }
      throw error
    }
  }

  cancel(): void {
    this.abortController?.abort()
  }

  validateConfig(config: AsyncProcessingConfig): boolean {
    if (config.type !== 'remote-download') return false

    const downloadConfig = config as RemoteDownloadConfig
    try {
      new URL(downloadConfig.url)
      return true
    } catch {
      return false
    }
  }

  private extractFileNameFromUrl(url: string): string {
    try {
      const urlObj = new URL(url)
      const pathname = urlObj.pathname
      const fileName = pathname.split('/').pop() || 'download'
      return fileName.includes('.') ? fileName : `${fileName}.bin`
    } catch {
      return 'download.bin'
    }
  }
}
```

### 5. å·¥ä½œæµç¨‹è®¾è®¡

#### 5.1 å¼‚æ­¥å¤„ç†ç´ ææµç¨‹
```mermaid
graph TD
    A[ç”¨æˆ·é€‰æ‹©å¼‚æ­¥å¤„ç†ç±»å‹] --> B[å¼¹å‡ºé…ç½®å¯¹è¯æ¡†]
    B --> C[é…ç½®å¤„ç†å‚æ•°å’Œé¢„è®¡æ—¶é•¿]
    C --> D[åˆ›å»ºå¼‚æ­¥å¤„ç†å ä½ç¬¦AsyncProcessingMediaItem]
    D --> E[æ·»åŠ åˆ°å¤„ç†ä¸­tab]
    E --> F[åœ¨asyncProcessingMediaReferencesä¸­åˆ›å»ºå ä½ç¬¦]
    F --> G[æ‹–æ‹½åˆ°æ—¶é—´è½´æ—¶åˆ›å»ºAsyncProcessingTimelineItem]
    G --> H[å¼€å§‹åå°å¤„ç†]
    H --> I[å®æ—¶æ›´æ–°å¤„ç†è¿›åº¦]
    I --> J[åŒæ­¥æ›´æ–°AsyncProcessingTimelineItemçŠ¶æ€]
    J --> K{å¤„ç†å®Œæˆ?}
    K -->|æ˜¯| L[æ£€æµ‹å®é™…åª’ä½“ç±»å‹]
    K -->|å¦| I
    L --> M{æ–‡ä»¶ç±»å‹æ”¯æŒ?}
    M -->|æ˜¯| N[è½¬æ¢ä¸ºæœ¬åœ°ç´ æ]
    M -->|å¦| O[æ ‡è®°ä¸ºé”™è¯¯çŠ¶æ€]
    O --> P[AsyncProcessingTimelineItemæ˜¾ç¤ºçº¢è‰²é”™è¯¯]
    N --> Q[æŸ¥æ‰¾ç›¸å…³AsyncProcessingTimelineItem]
    Q --> R[åˆ›å»ºLocalMediaItemå’ŒLocalMediaReference]
    R --> R1[ç§»é™¤AsyncProcessingMediaItemå’ŒAsyncProcessingMediaReference]
    R1 --> S[ç§»åŠ¨åˆ°å¯¹åº”tab]
    S --> T[åˆ›å»ºæ–°çš„TimelineItemå’Œsprite]
    T --> U[æ·»åŠ spriteåˆ°WebAVç”»å¸ƒ]
    U --> V[æ·»åŠ TimelineItemåˆ°æ—¶é—´è½´]
    V --> W[ç§»é™¤AsyncProcessingTimelineItem]
    W --> X[è½¨é“é‡æ–°åˆ†é…æ£€æŸ¥]
```

#### 5.2 ä¸åŒå¤„ç†ç±»å‹çš„å…·ä½“æµç¨‹

**è¿œç¨‹ä¸‹è½½æµç¨‹**ï¼š
1. ç”¨æˆ·è¾“å…¥URLå’Œé¢„è®¡æ—¶é•¿
2. éªŒè¯URLæ ¼å¼å’Œå¯è®¿é—®æ€§
3. åˆ›å»ºRemoteDownloadConfigé…ç½®
4. å¼€å§‹ä¸‹è½½ï¼Œå®æ—¶æ›´æ–°è¿›åº¦
5. ä¸‹è½½å®Œæˆåæ£€æµ‹æ–‡ä»¶ç±»å‹
6. è½¬æ¢ä¸ºæœ¬åœ°ç´ æ

**æ ¼å¼è½¬æ¢æµç¨‹**ï¼š
1. ç”¨æˆ·é€‰æ‹©æºæ–‡ä»¶å’Œç›®æ ‡æ ¼å¼
2. é…ç½®è½¬æ¢å‚æ•°ï¼ˆè´¨é‡ã€åˆ†è¾¨ç‡ç­‰ï¼‰
3. åˆ›å»ºFormatConversionConfigé…ç½®
4. ä½¿ç”¨FFmpegæˆ–WebCodecsè¿›è¡Œè½¬æ¢
5. å®æ—¶æ›´æ–°è½¬æ¢è¿›åº¦
6. è½¬æ¢å®Œæˆåæ›¿æ¢åŸæ–‡ä»¶

**AIå¢å¼ºæµç¨‹**ï¼š
1. ç”¨æˆ·é€‰æ‹©æºæ–‡ä»¶å’Œå¢å¼ºç±»å‹
2. é…ç½®AIæ¨¡å‹å‚æ•°
3. åˆ›å»ºAIEnhancementConfigé…ç½®
4. è°ƒç”¨AIæœåŠ¡è¿›è¡Œå¤„ç†
5. å®æ—¶æ›´æ–°å¤„ç†è¿›åº¦
6. å¤„ç†å®Œæˆåç”Ÿæˆå¢å¼ºç‰ˆæœ¬

#### 5.3 å¼‚æ­¥å¤„ç†ç´ æè½¬æ¢æµç¨‹ï¼ˆä¼˜åŒ–ç‰ˆï¼‰

**æ ¸å¿ƒè®¾è®¡åŸåˆ™**ï¼šè§£å†³WebAVè§£æè€—æ—¶æœŸé—´çš„æ—¶é—´è½´clipä¸¢å¤±é—®é¢˜ï¼Œé€šè¿‡éšè—å¼‚æ­¥ç´ æè€Œéåˆ é™¤æ¥ä¿æŒæ—¶é—´è½´clipçš„è¿ç»­æ€§ã€‚

1. **å¤„ç†å®Œæˆæ£€æµ‹**ï¼šAsyncProcessingMediaItem çš„ processedFile å­—æ®µä¸ä¸ºç©º

2. **ç±»å‹æ£€æµ‹**ï¼šæ ¹æ®å¤„ç†åçš„æ–‡ä»¶å¤´ä¿¡æ¯æ£€æµ‹å®é™…åª’ä½“ç±»å‹

3. **ç±»å‹æ”¯æŒæ£€æŸ¥**ï¼š
   ```typescript
   if (!isSupportedMediaType(processedFile)) {
     // æ ‡è®°ä¸ºä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹
     asyncProcessingMediaItem.processingStatus = 'unsupported'
     asyncProcessingMediaItem.errorMessage = `ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹: ${processedFile.type}`
     // ä¿æŒå ä½ç¬¦çŠ¶æ€ï¼Œä¸è¿›è¡Œè½¬æ¢
     return
   }
   ```

4. **éšè—å¼‚æ­¥ç´ æ**ï¼ˆä»…å½“æ–‡ä»¶ç±»å‹æ”¯æŒæ—¶ï¼‰ï¼š
   ```typescript
   // æ ‡è®°ä¸ºè½¬æ¢ä¸­ï¼ŒUIå±‚é¢éšè—æ˜¾ç¤º
   asyncProcessingMediaItem.isConverting = true
   ```
   - åª’ä½“åº“è¿‡æ»¤æ‰ `isConverting: true` çš„å¼‚æ­¥ç´ æ
   - æ—¶é—´è½´clipä¿æŒæ˜¾ç¤ºï¼Œå¼•ç”¨å…³ç³»ä¸å˜
   - é¿å…ç”¨æˆ·çœ‹åˆ°é‡å¤çš„ç´ æé¡¹

5. **åˆ›å»ºæœ¬åœ°ç´ æ**ï¼ˆä»…å½“æ–‡ä»¶ç±»å‹æ”¯æŒæ—¶ï¼‰ï¼š
   - ä½¿ç”¨ç°æœ‰çš„ `processFiles` é€»è¾‘å¤„ç† processedFile
   - åˆ›å»º LocalMediaItem å¯¹è±¡ï¼ˆä¸ç›´æ¥å¯¼å…¥çš„æœ¬åœ°ç´ æå®Œå…¨ç›¸åŒï¼‰
   - WebAV å¼€å§‹è§£æï¼Œåˆ›å»ºå¯¹åº”ç±»å‹çš„ Clipï¼ˆMP4Clip/ImgClip/AudioClipï¼‰
   - ç”Ÿæˆç¼©ç•¥å›¾

6. **ç­‰å¾…æœ¬åœ°ç´ æè§£æå®Œæˆ**ï¼š
   ```typescript
   // ç›‘å¬æœ¬åœ°ç´ æçš„ isReady çŠ¶æ€
   await waitForMediaItemReady(localMediaItem)
   ```

7. **ä¿å­˜æ—¶é—´è½´clipä¿¡æ¯**ï¼ˆåœ¨åˆ é™¤å‰ï¼‰ï¼š
   ```typescript
   const timelineClipInfos = timelineItems
     .filter(item => isAsyncProcessingTimelineItem(item) && item.mediaItemId === asyncProcessingMediaItem.id)
     .map(item => ({
       trackId: item.trackId,
       timelineStartTime: item.timeRange.timelineStartTime,
       originalDuration: item.timeRange.timelineEndTime - item.timeRange.timelineStartTime,
       config: item.config,
       // ä¿å­˜å…¶ä»–éœ€è¦çš„é…ç½®ä¿¡æ¯
     }))
   ```

8. **åˆ é™¤å¼‚æ­¥ç´ æ**ï¼š
   - ä»å¼‚æ­¥å¤„ç†åˆ—è¡¨ä¸­ç§»é™¤ AsyncProcessingMediaItem
   - è¿å¸¦åˆ é™¤æ‰€æœ‰ç›¸å…³çš„ AsyncProcessingTimelineItem
   - æ¸…ç† AsyncProcessingMediaReference

9. **é‡å»ºæ—¶é—´è½´clip**ï¼ˆåŸºäºä¿å­˜çš„ä¿¡æ¯ï¼‰ï¼š
   ```typescript
   for (const clipInfo of timelineClipInfos) {
     // åˆ›å»ºæ–°çš„sprite
     const newSprite = await createSpriteFromMediaItem(localMediaItem)

     // æ—¶é•¿è°ƒæ•´ï¼šä½¿ç”¨å®é™…æ—¶é•¿
     const actualDuration = localMediaItem.duration
     const newTimeRange = {
       timelineStartTime: clipInfo.timelineStartTime,
       timelineEndTime: clipInfo.timelineStartTime + actualDuration,
       // ... å…¶ä»–æ—¶é—´èŒƒå›´å±æ€§
     }

     // åˆ›å»ºæ–°çš„LocalTimelineItem
     const newTimelineItem: LocalTimelineItem = {
       id: generateNewTimelineItemId(),
       mediaItemId: localMediaItem.id,
       trackId: clipInfo.trackId,
       mediaType: localMediaItem.mediaType,
       timeRange: newTimeRange,
       sprite: markRaw(newSprite),
       config: createDefaultConfigForMediaType(localMediaItem.mediaType),
       mediaName: localMediaItem.name
     }

     // æ·»åŠ åˆ°æ—¶é—´è½´
     addTimelineItem(newTimelineItem)
     addSpriteToCanvas(newSprite)
   }
   ```

10. **å®Œæˆè½¬æ¢**ï¼š
    - æœ¬åœ°ç´ ææ­£å¸¸æ˜¾ç¤ºåœ¨å¯¹åº”tabä¸­
    - æ—¶é—´è½´clipæ— ç¼åˆ‡æ¢åˆ°æ–°çš„LocalTimelineItem
    - ç”¨æˆ·çœ‹åˆ°çš„æ˜¯è¿ç»­çš„è½¬æ¢è¿‡ç¨‹ï¼Œæ²¡æœ‰clipæ¶ˆå¤±

11. **é”™è¯¯çŠ¶æ€å¤„ç†**ï¼ˆå½“æ–‡ä»¶ç±»å‹ä¸æ”¯æŒæˆ–è½¬æ¢å¤±è´¥æ—¶ï¼‰ï¼š
    - é‡æ–°æ˜¾ç¤ºå¼‚æ­¥ç´ æï¼ˆ`isConverting = false`ï¼‰
    - æ›´æ–°çŠ¶æ€ä¸ºé”™è¯¯ï¼š`processingStatus = 'error'`
    - æ—¶é—´è½´å ä½ç¬¦æ˜¾ç¤ºçº¢è‰²é”™è¯¯çŠ¶æ€
    - å±æ€§é¢æ¿æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯å’Œé‡æ–°é…ç½®é€‰é¡¹

**é‡è¦è¯´æ˜**ï¼šä¼˜åŒ–åçš„è½¬æ¢ç­–ç•¥è§£å†³äº†æ—¶é—´è½´clipä¸¢å¤±é—®é¢˜ï¼š

**æ ¸å¿ƒé—®é¢˜**ï¼šWebAVè§£ææ–‡ä»¶éœ€è¦æ—¶é—´ï¼Œåœ¨è¿™ä¸ªæ—¶é—´çª—å£å†…å¦‚æœåˆ é™¤å¼‚æ­¥ç´ æï¼Œä¼šå¯¼è‡´æ—¶é—´è½´clipä¸¢å¤±ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š**éšè—è€Œéåˆ é™¤**çš„ç­–ç•¥ï¼š
- **éšè—å¼‚æ­¥ç´ æ**ï¼šæ ‡è®° `isConverting: true`ï¼ŒUIå±‚é¢è¿‡æ»¤ä¸æ˜¾ç¤º
- **ä¿æŒå¼•ç”¨å…³ç³»**ï¼šæ—¶é—´è½´clipçš„ `mediaItemId` å¼•ç”¨ä¿æŒæœ‰æ•ˆ
- **ç­‰å¾…è§£æå®Œæˆ**ï¼šæœ¬åœ°ç´ æå®Œå…¨å‡†å¤‡å¥½åå†è¿›è¡Œæ›¿æ¢
- **ä¿¡æ¯ä¿å­˜é‡å»º**ï¼šä¿å­˜æ—§clipä¿¡æ¯ï¼Œåˆ é™¤ååŸºäºè¿™äº›ä¿¡æ¯é‡å»ºæ–°clip

**è½¬æ¢ç­–ç•¥å¯¹æ¯”**ï¼š

**æ—¶é—´è½´è½¬æ¢**ï¼š**ä¿å­˜ä¿¡æ¯ â†’ åˆ é™¤æ—§clip â†’ é‡å»ºæ–°clip**çš„è¿‡ç¨‹ï¼š
- **æ•°æ®å®‰å…¨**ï¼šé€šè¿‡ä¿¡æ¯ä¿å­˜é¿å…clipé…ç½®ä¸¢å¤±
- **ç±»å‹å®‰å…¨**ï¼šAsyncProcessingTimelineItem å’Œ LocalTimelineItem æ˜¯ä¸åŒçš„ç±»å‹
- **æ—¶é•¿å‡†ç¡®**ï¼šæ ¹æ®å®é™…æ–‡ä»¶æ—¶é•¿è°ƒæ•´clipèŒƒå›´ï¼Œè€Œä¸æ˜¯ä½¿ç”¨é¢„ä¼°æ—¶é•¿
- **ç”¨æˆ·ä½“éªŒ**ï¼šé¿å…clipçªç„¶æ¶ˆå¤±åˆæ‰¾ä¸å›æ¥çš„é—®é¢˜

**åª’ä½“åº“è½¬æ¢**ï¼š**éšè— â†’ åˆ›å»ºæœ¬åœ°ç´ æ â†’ ç­‰å¾…è§£æ â†’ åˆ é™¤å¼‚æ­¥ç´ æ**çš„è¿‡ç¨‹ï¼š
- **é¿å…é‡å¤æ˜¾ç¤º**ï¼šé€šè¿‡éšè—æœºåˆ¶é˜²æ­¢åŒæ—¶æ˜¾ç¤ºä¸¤ä¸ªç´ æ
- **æ—¶åºæ§åˆ¶**ï¼šç¡®ä¿æœ¬åœ°ç´ æå®Œå…¨å‡†å¤‡å¥½åå†æ¸…ç†å¼‚æ­¥ç´ æ
- **é”™è¯¯æ¢å¤**ï¼šè½¬æ¢å¤±è´¥æ—¶å¯ä»¥é‡æ–°æ˜¾ç¤ºå¼‚æ­¥ç´ æ

#### 5.4 å¼‚æ­¥å¤„ç†æ—¶é—´è½´clipå¤„ç†

**AsyncProcessingTimelineItem ç‰¹æ€§**ï¼š
- ä¸“é—¨çš„å¼‚æ­¥å¤„ç†clipç±»å‹ï¼Œä¸åˆ›å»º WebAV sprite
- æ ¹æ® processingStatus å’Œ processingType æ˜¾ç¤ºä¸åŒçš„è§†è§‰æ•ˆæœï¼š
  - `pending`ï¼šæ©™è‰²èƒŒæ™¯ï¼Œæ˜¾ç¤ºç­‰å¾…å›¾æ ‡å’Œå¤„ç†ç±»å‹
  - `processing`ï¼šè“è‰²èƒŒæ™¯ï¼Œæ˜¾ç¤ºå¤„ç†è¿›åº¦æ¡ã€ç™¾åˆ†æ¯”å’Œå¤„ç†ç±»å‹å›¾æ ‡
  - `unsupported`ï¼šçº¢è‰²èƒŒæ™¯ï¼Œä¸­å¤®æ˜¾ç¤º"é”™è¯¯"æ–‡å­—
  - `error`ï¼šçº¢è‰²èƒŒæ™¯ï¼Œæ˜¾ç¤ºå…·ä½“é”™è¯¯ä¿¡æ¯
  - `completed`ï¼šç»¿è‰²èƒŒæ™¯ï¼Œæ˜¾ç¤ºå®ŒæˆçŠ¶æ€ï¼ˆçŸ­æš‚æ˜¾ç¤ºåè½¬æ¢ï¼‰
- ç¦ç”¨æ‰€æœ‰ç¼–è¾‘åŠŸèƒ½ï¼ˆè£å‰ªã€å¤åˆ¶ã€åˆ†å‰²ã€åŠ¨ç”»ç­‰ï¼‰
- æ”¯æŒåŸºæœ¬æ“ä½œï¼šé€‰ä¸­ã€åˆ é™¤ã€æ‹–æ‹½ç§»åŠ¨
- å±æ€§é¢æ¿æ˜¾ç¤ºå¤„ç†ä¿¡æ¯ï¼ˆç±»å‹ã€é…ç½®ã€è¿›åº¦ã€é¢„è®¡æ—¶é•¿ã€é”™è¯¯ä¿¡æ¯ï¼‰

**AsyncProcessingTimelineItem è½¬æ¢æµç¨‹**ï¼š
```typescript
// 1. æŸ¥æ‰¾éœ€è¦è½¬æ¢çš„å¼‚æ­¥å¤„ç†æ—¶é—´è½´é¡¹ç›®
const asyncProcessingTimelineItems = timelineItems.value.filter(
  item => isAsyncProcessingTimelineItem(item) && item.mediaItemId === asyncProcessingMediaItem.id
) as AsyncProcessingTimelineItem[]

// 2. æ ¹æ®å¼‚æ­¥å¤„ç†ç´ æçŠ¶æ€å¤„ç†
if (asyncProcessingMediaItem.processingStatus === 'unsupported') {
  // æ–‡ä»¶ç±»å‹ä¸æ”¯æŒï¼Œæ›´æ–°AsyncProcessingTimelineItemæ˜¾ç¤ºé”™è¯¯çŠ¶æ€
  for (const asyncProcessingItem of asyncProcessingTimelineItems) {
    asyncProcessingItem.processingStatus = 'unsupported'
    asyncProcessingItem.errorMessage = asyncProcessingMediaItem.errorMessage
    // ä¿æŒAsyncProcessingTimelineItemçŠ¶æ€ï¼Œä¸è½¬æ¢
  }
} else if (asyncProcessingMediaItem.processingStatus === 'completed') {
  // æ–‡ä»¶ç±»å‹æ”¯æŒï¼Œè½¬æ¢ä¸ºLocalTimelineItem
  for (const asyncProcessingItem of asyncProcessingTimelineItems) {
    // ä¿å­˜åŸæœ‰é…ç½®
    const originalTimeRange = asyncProcessingItem.timeRange
    const originalTrackId = asyncProcessingItem.trackId
    const originalId = asyncProcessingItem.id

    // 1. åˆ›å»ºæ–°çš„spriteï¼ˆåŸºäºè½¬æ¢åçš„æœ¬åœ°ç´ æï¼‰
    const newSprite = await createSpriteFromLocalMediaItem(localMediaItem)

    // 2. å¤„ç†æ—¶é•¿ä¸åŒ¹é…çš„æƒ…å†µ
    const originalDuration = originalTimeRange.timelineEndTime - originalTimeRange.timelineStartTime
    const actualDuration = localMediaItem.duration // å®é™…æ–‡ä»¶æ—¶é•¿ï¼ˆå¸§æ•°ï¼‰

    let newTimeRange: VideoTimeRange | ImageTimeRange
    if (actualDuration !== originalDuration) {
      // å®é™…æ—¶é•¿ä¸é¢„ä¼°æ—¶é•¿ä¸ç¬¦ï¼Œä½¿ç”¨å®é™…æ—¶é•¿
      console.log(`â±ï¸ æ—¶é•¿è°ƒæ•´: é¢„ä¼°${originalDuration}å¸§ â†’ å®é™…${actualDuration}å¸§`)
    }

    // æ ¹æ®å®é™…åª’ä½“ç±»å‹åˆ›å»ºå¯¹åº”çš„æ—¶é—´èŒƒå›´
    if (localMediaItem.mediaType === 'video' || localMediaItem.mediaType === 'audio') {
      newTimeRange = {
        clipStartTime: 0,
        clipEndTime: actualDuration,
        timelineStartTime: originalTimeRange.timelineStartTime,
        timelineEndTime: originalTimeRange.timelineStartTime + actualDuration,
        effectiveDuration: actualDuration,
        playbackRate: 1.0
      } as VideoTimeRange
    } else {
      // å›¾ç‰‡ç±»å‹
      newTimeRange = {
        timelineStartTime: originalTimeRange.timelineStartTime,
        timelineEndTime: originalTimeRange.timelineStartTime + actualDuration,
        displayDuration: actualDuration
      } as ImageTimeRange
    }

    newSprite.setTimeRange(newTimeRange)

    // 3. æ£€æŸ¥è½¨é“å…¼å®¹æ€§ï¼Œå¿…è¦æ—¶é‡æ–°åˆ†é…
    let targetTrackId = originalTrackId
    if (needsTrackReassignment(originalTrackId, localMediaItem.mediaType)) {
      targetTrackId = findCompatibleTrack(localMediaItem.mediaType)
      console.log(`ğŸ”„ è½¨é“é‡æ–°åˆ†é…: ${originalTrackId} â†’ ${targetTrackId}`)
    }

    // 4. åˆ›å»ºæ–°çš„LocalTimelineItem
    const newTimelineItem: LocalTimelineItem = {
      id: generateNewTimelineItemId(), // ç”Ÿæˆæ–°çš„ID
      mediaItemId: localMediaItem.id,
      trackId: targetTrackId,
      mediaType: localMediaItem.mediaType,
      timeRange: newSprite.getTimeRange(), // ä½¿ç”¨spriteè¿”å›çš„æ­£ç¡®æ—¶é—´èŒƒå›´ç±»å‹
      sprite: markRaw(newSprite),
      config: createDefaultConfigForMediaType(localMediaItem.mediaType),
      mediaName: localMediaItem.name
    }

    // 5. æ·»åŠ spriteåˆ°WebAVç”»å¸ƒ
    avCanvas.addSprite(newSprite)
    console.log(`ğŸ¨ æ·»åŠ spriteåˆ°ç”»å¸ƒ: ${newTimelineItem.id}`)

    // 6. æ·»åŠ æ–°çš„LocalTimelineItemåˆ°æ—¶é—´è½´
    timelineItems.value.push(newTimelineItem)
    console.log(`âœ… æ·»åŠ æ–°LocalTimelineItem: ${newTimelineItem.id}`)

    // 7. ä»æ—¶é—´è½´ç§»é™¤AsyncProcessingTimelineItem
    const asyncProcessingItemIndex = timelineItems.value.findIndex(item => item.id === originalId)
    if (asyncProcessingItemIndex !== -1) {
      timelineItems.value.splice(asyncProcessingItemIndex, 1)
      console.log(`ğŸ—‘ï¸ ç§»é™¤AsyncProcessingTimelineItem: ${originalId}`)
    }

    // 8. è§¦å‘UIæ›´æ–°ï¼ˆå¦‚æœå½“å‰é€‰ä¸­çš„æ˜¯è¢«æ›¿æ¢çš„é¡¹ç›®ï¼‰
    if (selectedTimelineItemId.value === originalId) {
      selectedTimelineItemId.value = newTimelineItem.id
    }
  }
}
```

**è½¨é“é‡æ–°åˆ†é…é€»è¾‘**ï¼š
- å¼‚æ­¥å¤„ç†â†’è§†é¢‘ï¼šç§»åŠ¨åˆ°æœ€è¿‘çš„è§†é¢‘è½¨é“
- å¼‚æ­¥å¤„ç†â†’éŸ³é¢‘ï¼šç§»åŠ¨åˆ°æœ€è¿‘çš„éŸ³é¢‘è½¨é“
- å¼‚æ­¥å¤„ç†â†’å›¾ç‰‡ï¼šç§»åŠ¨åˆ°æœ€è¿‘çš„è§†é¢‘è½¨é“ï¼ˆå›¾ç‰‡ä½¿ç”¨è§†é¢‘è½¨é“ï¼‰
- å¦‚æœç›®æ ‡è½¨é“ä¸å­˜åœ¨ï¼Œè‡ªåŠ¨åˆ›å»ºæ–°è½¨é“

**AsyncProcessingTimelineItem æ‹–æ‹½è§„åˆ™**ï¼š
- å¯ä»¥æ‹–æ‹½åˆ°ä»»ä½•è½¨é“ï¼ˆå› ä¸ºå®é™…ç±»å‹æœªçŸ¥ï¼‰
- è½¬æ¢æ—¶æ ¹æ®å®é™…ç±»å‹é‡æ–°åˆ†é…åˆ°åˆé€‚è½¨é“
- é”™è¯¯çŠ¶æ€çš„AsyncProcessingTimelineItemå¯ä»¥åˆ é™¤ä½†ä¸èƒ½è½¬æ¢

### 6. æŒä¹…åŒ–è®¾è®¡

#### 6.1 é¡¹ç›®ä¿å­˜ç»“æ„ï¼ˆproject.jsonï¼‰

åŸºäºç°æœ‰çš„ProjectConfigæ¥å£å’Œæ–°çš„ç»§æ‰¿å…³ç³»è®¾è®¡ï¼š

```json
{
  "id": "project_1234567890",
  "name": "æˆ‘çš„è§†é¢‘é¡¹ç›®",
  "description": "åŒ…å«å¼‚æ­¥å¤„ç†ç´ æçš„è§†é¢‘é¡¹ç›®",
  "createdAt": "2024-01-01T00:00:00.000Z",
  "updatedAt": "2024-01-01T12:00:00.000Z",
  "version": "1.0.0",
  "thumbnail": "thumbnails/project_thumb.jpg",
  "duration": "00:02:30",

  // é¡¹ç›®è®¾ç½®
  "settings": {
    "videoResolution": {
      "name": "1080p",
      "width": 1920,
      "height": 1080,
      "aspectRatio": "16:9"
    },
    "frameRate": 30,
    "timelineDurationFrames": 1800
  },

  // æ—¶é—´è½´æ•°æ®ï¼ˆä¸åŒ…å«è¿è¡Œæ—¶çŠ¶æ€ï¼‰
  "timeline": {
    "tracks": [
      {
        "id": "track_video_1",
        "name": "è§†é¢‘è½¨é“ 1",
        "type": "video",
        "isVisible": true,
        "isMuted": false,
        "height": 60
      },
      {
        "id": "track_audio_1",
        "name": "éŸ³é¢‘è½¨é“ 1",
        "type": "audio",
        "isVisible": true,
        "isMuted": false,
        "height": 40
      }
    ],

    // æ—¶é—´è½´é¡¹ç›®æ•°æ®ï¼ˆåŒ…å«æœ¬åœ°å’Œå¼‚æ­¥å¤„ç†é¡¹ç›®ï¼‰
    "timelineItems": [
      // æœ¬åœ°æ—¶é—´è½´é¡¹ç›®ï¼ˆæŒä¹…åŒ–æ•°æ®ï¼Œä¸åŒ…å«spriteç­‰è¿è¡Œæ—¶çŠ¶æ€ï¼‰
      {
        "id": "timeline_local_001",
        "mediaItemId": "local_item_123",
        "trackId": "track_video_1",
        "mediaType": "video",
        "timeRange": {
          "clipStartTime": 0,
          "clipEndTime": 300,
          "timelineStartTime": 0,
          "timelineEndTime": 300,
          "effectiveDuration": 300,
          "playbackRate": 1.0
        },
        "config": {
          "x": 0,
          "y": 0,
          "width": 1920,
          "height": 1080,
          "rotation": 0,
          "opacity": 1,
          "volume": 1,
          "isMuted": false
        },
        "mediaName": "æœ¬åœ°è§†é¢‘.mp4"
      },

      // å¼‚æ­¥å¤„ç†æ—¶é—´è½´é¡¹ç›®ï¼ˆæŒä¹…åŒ–æ•°æ®ï¼‰
      {
        "id": "timeline_async_001",
        "mediaItemId": "async_item_456",
        "trackId": "track_audio_1",
        "mediaType": "unknown",
        "timeRange": {
          "timelineStartTime": 300,
          "timelineEndTime": 450
        },
        "config": {
          "name": "ç½‘ç»œéŸ³é¢‘",
          "expectedDuration": 150
        },
        "isAsyncProcessingPlaceholder": true,
        "processingType": "remote-download",
        "processingStatus": "pending"
        // æ³¨æ„ï¼šprocessingProgress ä¸æŒä¹…åŒ–ï¼Œé‡æ–°æ‰“å¼€æ—¶ä»0å¼€å§‹
      }
    ],

    // åª’ä½“é¡¹ç›®æ•°æ®ï¼ˆåŒ…å«æœ¬åœ°å’Œå¼‚æ­¥å¤„ç†é¡¹ç›®ï¼Œä¸åŒ…å«è¿è¡Œæ—¶çŠ¶æ€ï¼‰
    "mediaItems": [
      // æœ¬åœ°åª’ä½“é¡¹ç›®æ•°æ®
      {
        "id": "local_item_123",
        "name": "æœ¬åœ°è§†é¢‘.mp4",
        "mediaType": "video",
        "duration": 300,
        "type": "video/mp4",
        "createdAt": "2024-01-01T10:00:00.000Z"
      },

      // å¼‚æ­¥å¤„ç†åª’ä½“é¡¹ç›®æ•°æ®
      {
        "id": "async_item_456",
        "name": "ç½‘ç»œéŸ³é¢‘.mp3",
        "mediaType": "unknown",
        "isAsyncProcessing": true,
        "processingType": "remote-download",
        "processingStatus": "pending",
        "expectedDuration": 150,
        "processingConfig": {
          "type": "remote-download",
          "url": "https://example.com/audio.mp3",
          "timeout": 30000
        },
        "createdAt": "2024-01-01T11:00:00.000Z"
        // æ³¨æ„ï¼šprocessingProgress, startedAt, completedAt ç­‰è¿è¡Œæ—¶çŠ¶æ€ä¸æŒä¹…åŒ–
      }
    ]
  },

  // æœ¬åœ°åª’ä½“æ–‡ä»¶å¼•ç”¨ï¼ˆåŒ…æ‹¬å·²è½¬æ¢çš„å¼‚æ­¥å¤„ç†ç´ æï¼‰
  "localMediaReferences": {
    "local_item_123": {
      "originalFileName": "local_video.mp4",
      "storedPath": "media/videos/local_video.mp4",
      "type": "video",
      "fileSize": 2048000,
      "checksum": "def456"
    }
  },

  // å¼‚æ­¥å¤„ç†åª’ä½“å¼•ç”¨ï¼ˆä»…åŒ…æ‹¬å¤„ç†ä¸­å’Œé”™è¯¯çŠ¶æ€çš„ç´ æï¼Œè½¬æ¢å®Œæˆåä¼šè¢«æ¸…ç†ï¼‰
  "asyncProcessingMediaReferences": {
    "async_item_456": {
      "originalFileName": "processing_audio.mp3",
      "processingType": "remote-download",
      "processingConfig": {
        "type": "remote-download",
        "url": "https://example.com/audio.mp3",
        "timeout": 30000
      },
      "expectedDuration": 150,
      "isAsyncProcessingPlaceholder": true,
      "type": "unknown",
      "fileSize": 0,
      "checksum": ""
    }
  },

  // å¯¼å‡ºè®°å½•
  "exports": []
}
```

#### 6.2 é¡¹ç›®åŠ è½½æ¢å¤æœºåˆ¶

**åŠ è½½æµç¨‹æ¦‚è¿°**ï¼š
```typescript
async function loadProjectContent(projectId: string): Promise<void> {
  // 1. åŠ è½½é¡¹ç›®é…ç½®
  const projectConfig = await loadProjectConfig(projectId)

  // 2. åˆ†åˆ«å¤„ç†æœ¬åœ°å’Œå¼‚æ­¥å¤„ç†åª’ä½“é¡¹ç›®
  const { localMediaItems, asyncProcessingMediaItems } = separateMediaItems(projectConfig.timeline.mediaItems)

  // 3. æ¢å¤æœ¬åœ°åª’ä½“é¡¹ç›®
  await restoreLocalMediaItems(localMediaItems, projectConfig.localMediaReferences)

  // 4. æ¢å¤å¼‚æ­¥å¤„ç†åª’ä½“é¡¹ç›®ï¼ˆé‡ç½®è¿è¡Œæ—¶çŠ¶æ€ï¼‰
  await restoreAsyncProcessingMediaItems(asyncProcessingMediaItems, projectConfig.asyncProcessingMediaReferences)

  // 5. é‡å»ºæ—¶é—´è½´é¡¹ç›®
  await rebuildTimelineItems(projectConfig.timeline.timelineItems)
}
```

**è¯¦ç»†æ¢å¤æ­¥éª¤**ï¼š

1. **æœ¬åœ°åª’ä½“é¡¹ç›®æ¢å¤**ï¼š
   ```typescript
   async function restoreLocalMediaItems(
     localMediaItems: LocalMediaItemData[],
     localMediaReferences: Record<string, LocalMediaReference>
   ): Promise<LocalMediaItem[]> {
     const restoredItems: LocalMediaItem[] = []

     for (const itemData of localMediaItems) {
       const reference = localMediaReferences[itemData.id]
       if (!reference) {
         console.warn(`æœ¬åœ°åª’ä½“å¼•ç”¨ç¼ºå¤±: ${itemData.id}`)
         continue
       }

       // ä»æœ¬åœ°æ–‡ä»¶é‡æ–°åˆ›å»ºWebAV Clip
       const file = await loadFileFromPath(reference.storedPath)
       const clip = await createWebAVClip(file, itemData.mediaType)

       // é‡å»ºLocalMediaItem
       const localMediaItem: LocalMediaItem = {
         ...itemData,
         file,
         url: URL.createObjectURL(file),
         mp4Clip: itemData.mediaType === 'video' ? clip : null,
         imgClip: itemData.mediaType === 'image' ? clip : null,
         audioClip: itemData.mediaType === 'audio' ? clip : null,
         isReady: false, // é‡æ–°è§£æ
         status: 'parsing'
       }

       restoredItems.push(localMediaItem)
     }

     return restoredItems
   }
   ```

2. **å¼‚æ­¥å¤„ç†åª’ä½“é¡¹ç›®æ¢å¤**ï¼š
   ```typescript
   async function restoreAsyncProcessingMediaItems(
     asyncProcessingMediaItems: AsyncProcessingMediaItemData[],
     asyncProcessingReferences: Record<string, AsyncProcessingMediaReference>
   ): Promise<AsyncProcessingMediaItem[]> {
     const restoredItems: AsyncProcessingMediaItem[] = []

     for (const itemData of asyncProcessingMediaItems) {
       const reference = asyncProcessingReferences[itemData.id]
       if (!reference) {
         console.warn(`å¼‚æ­¥å¤„ç†åª’ä½“å¼•ç”¨ç¼ºå¤±: ${itemData.id}`)
         continue
       }

       // é‡å»ºAsyncProcessingMediaItemï¼Œé‡ç½®æ‰€æœ‰è¿è¡Œæ—¶çŠ¶æ€
       const asyncProcessingMediaItem: AsyncProcessingMediaItem = {
         ...itemData,
         // é‡ç½®è¿è¡Œæ—¶çŠ¶æ€ - ç½‘é¡µåº”ç”¨é‡æ–°æ‰“å¼€æ—¶ï¼Œæ‰€æœ‰å¤„ç†éƒ½éœ€è¦é‡æ–°å¼€å§‹
         processingProgress: 0,
         processingStatus: 'pending', // é‡ç½®ä¸ºç­‰å¾…çŠ¶æ€
         processedFile: undefined,
         errorMessage: undefined,
         thumbnailUrl: undefined,
         startedAt: undefined,
         completedAt: undefined,
         isConverting: false
       }

       // æŒä¹…åŒ–çš„é”™è¯¯çŠ¶æ€å¯ä»¥ä¿ç•™ï¼Œä½†éœ€è¦é‡ç½®ä¸ºå¯é‡è¯•çŠ¶æ€
       if (reference.processingStatus === 'error' && reference.errorMessage) {
         asyncProcessingMediaItem.processingStatus = 'error'
         asyncProcessingMediaItem.errorMessage = reference.errorMessage
         console.log(`æ¢å¤é”™è¯¯çŠ¶æ€çš„å¼‚æ­¥å¤„ç†ç´ æ: ${itemData.id}, é”™è¯¯: ${reference.errorMessage}`)
       }

       restoredItems.push(asyncProcessingMediaItem)

       // è‡ªåŠ¨é‡æ–°å¯åŠ¨å¤„ç†ä»»åŠ¡ï¼ˆé™¤éæ˜¯é”™è¯¯çŠ¶æ€ï¼‰
       if (asyncProcessingMediaItem.processingStatus === 'pending') {
         console.log(`è‡ªåŠ¨é‡æ–°å¯åŠ¨å¼‚æ­¥å¤„ç†ä»»åŠ¡: ${itemData.id}`)
         asyncProcessingManager.startProcessing(asyncProcessingMediaItem)
       }
     }

     return restoredItems
   }
   ```

3. **æ—¶é—´è½´é¡¹ç›®é‡å»º**ï¼š
   ```typescript
   async function rebuildTimelineItems(
     timelineItemsData: (LocalTimelineItemData | AsyncProcessingTimelineItemData)[]
   ): Promise<AnyTimelineItem[]> {
     const rebuiltItems: AnyTimelineItem[] = []

     for (const itemData of timelineItemsData) {
       if (isAsyncProcessingTimelineItemData(itemData)) {
         // é‡å»ºAsyncProcessingTimelineItemï¼Œé‡ç½®è¿è¡Œæ—¶çŠ¶æ€
         const asyncProcessingMediaItem = findAsyncProcessingMediaItem(itemData.mediaItemId)
         if (asyncProcessingMediaItem) {
           const asyncProcessingTimelineItem: AsyncProcessingTimelineItem = {
             ...itemData,
             // åŒæ­¥åª’ä½“é¡¹ç›®çš„çŠ¶æ€ï¼Œä½†é‡ç½®è¿›åº¦
             processingType: asyncProcessingMediaItem.processingType,
             processingStatus: asyncProcessingMediaItem.processingStatus,
             processingProgress: 0, // é‡ç½®è¿›åº¦
             errorMessage: asyncProcessingMediaItem.errorMessage,
             sprite: null
           }
           rebuiltItems.push(asyncProcessingTimelineItem)
         }
       } else {
         // é‡å»ºLocalTimelineItem
         const localMediaItem = findLocalMediaItem(itemData.mediaItemId)
         if (localMediaItem) {
           const sprite = await createSpriteFromLocalMediaItem(localMediaItem)
           sprite.setTimeRange(itemData.timeRange)

           const localTimelineItem: LocalTimelineItem = {
             ...itemData,
             sprite: markRaw(sprite)
           }
           rebuiltItems.push(localTimelineItem)
         }
       }
     }

     return rebuiltItems
   }
   ```

#### 6.3 ç½‘é¡µåº”ç”¨çš„ç‰¹æ®Šè€ƒè™‘

**ä¸ºä»€ä¹ˆä¸æŒä¹…åŒ–è¿è¡Œæ—¶çŠ¶æ€ï¼Ÿ**

1. **è¿›ç¨‹ç”Ÿå‘½å‘¨æœŸ**ï¼š
   ```typescript
   // âŒ é”™è¯¯çš„è®¾è®¡ - æŒä¹…åŒ–è¿è¡Œæ—¶çŠ¶æ€
   {
     "processingProgress": 65,  // ç½‘é¡µå…³é—­åè¿™ä¸ªè¿›åº¦å°±æ— æ„ä¹‰äº†
     "startedAt": "2024-01-01T11:05:00.000Z"  // é‡æ–°æ‰“å¼€æ—¶éœ€è¦é‡æ–°å¼€å§‹
   }

   // âœ… æ­£ç¡®çš„è®¾è®¡ - åªæŒä¹…åŒ–é…ç½®å’Œé”™è¯¯çŠ¶æ€
   {
     "processingStatus": "pending",  // é‡æ–°æ‰“å¼€æ—¶é‡æ–°å¼€å§‹
     "processingConfig": { ... },    // å¤„ç†é…ç½®ä¿ç•™
     "errorMessage": "..."           // é”™è¯¯ä¿¡æ¯ä¿ç•™ï¼ˆå¦‚æœæœ‰ï¼‰
   }
   ```

2. **ç½‘é¡µåº”ç”¨ç‰¹æ€§**ï¼š
   - **æ— åå°å¤„ç†**ï¼šç½‘é¡µå…³é—­åï¼Œæ‰€æœ‰JavaScriptæ‰§è¡Œéƒ½åœæ­¢
   - **æ— æŒä¹…è¿›ç¨‹**ï¼šä¸åƒæ¡Œé¢åº”ç”¨ï¼Œç½‘é¡µåº”ç”¨æ— æ³•åœ¨åå°ç»§ç»­å¤„ç†
   - **é‡æ–°å¯åŠ¨æˆæœ¬ä½**ï¼šé‡æ–°å¼€å§‹å¼‚æ­¥å¤„ç†æ¯”æ¢å¤ä¸­é—´çŠ¶æ€æ›´å¯é 

3. **ç”¨æˆ·ä½“éªŒè€ƒè™‘**ï¼š
   - **çŠ¶æ€æ¸…æ™°**ï¼šç”¨æˆ·é‡æ–°æ‰“å¼€é¡¹ç›®æ—¶ï¼Œæ¸…æ¥šåœ°çœ‹åˆ°å“ªäº›ä»»åŠ¡éœ€è¦é‡æ–°å¤„ç†
   - **é¿å…æ··ä¹±**ï¼šä¸ä¼šå‡ºç°"æ˜¾ç¤º65%ä½†å®é™…éœ€è¦é‡æ–°å¼€å§‹"çš„å›°æƒ‘
   - **å¯é¢„æœŸè¡Œä¸º**ï¼šç”¨æˆ·æœŸæœ›é‡æ–°æ‰“å¼€ç½‘é¡µæ—¶ï¼Œæœªå®Œæˆçš„ä»»åŠ¡é‡æ–°å¼€å§‹

4. **æŠ€æœ¯å®ç°ç®€åŒ–**ï¼š
   - **æ— éœ€çŠ¶æ€æ¢å¤é€»è¾‘**ï¼šä¸éœ€è¦å¤æ‚çš„ä¸­é—´çŠ¶æ€æ¢å¤æœºåˆ¶
   - **é¿å…æ•°æ®ä¸ä¸€è‡´**ï¼šä¸ä¼šå‡ºç°æŒä¹…åŒ–çŠ¶æ€ä¸å®é™…çŠ¶æ€ä¸åŒ¹é…çš„é—®é¢˜
   - **ç®€åŒ–é”™è¯¯å¤„ç†**ï¼šåªéœ€è¦å¤„ç†"å¼€å§‹"å’Œ"å®Œæˆ"ä¸¤ç§çŠ¶æ€

#### 6.4 æŒä¹…åŒ–è®¾è®¡çš„å…³é”®è€ƒè™‘

**ä¸ºä»€ä¹ˆè¦åˆ†ç¦»å­˜å‚¨ localMediaReferences å’Œ asyncProcessingMediaReferencesï¼Ÿ**

1. **æ•°æ®ä¸€è‡´æ€§**ï¼š
   - `localMediaReferences` åªå­˜å‚¨å·²ç»ä¸‹è½½åˆ°æœ¬åœ°çš„æ–‡ä»¶å¼•ç”¨
   - `asyncProcessingMediaReferences` å­˜å‚¨å¼‚æ­¥å¤„ç†ç´ æçš„å…ƒä¿¡æ¯å’ŒçŠ¶æ€
   - é¿å…äº†åŒä¸€ä¸ªç´ æåœ¨ä¸åŒçŠ¶æ€ä¸‹çš„æ•°æ®æ··ä¹±

2. **åŠ è½½æ€§èƒ½**ï¼š
   - æœ¬åœ°ç´ æå¯ä»¥ç«‹å³åŠ è½½å’Œä½¿ç”¨
   - å¼‚æ­¥å¤„ç†ç´ æéœ€è¦é‡æ–°å¤„ç†ï¼Œåˆ†ç¦»å­˜å‚¨ä¾¿äºåŒºåˆ«å¤„ç†
   - é¿å…äº†åŠ è½½æ—¶çš„ç±»å‹åˆ¤æ–­å¤æ‚æ€§

3. **çŠ¶æ€ç®¡ç†**ï¼š
   - å¼‚æ­¥å¤„ç†ç´ æçš„çŠ¶æ€ï¼ˆpending/processing/error/completedï¼‰éœ€è¦ç‰¹æ®Šå¤„ç†
   - è½¬æ¢å®Œæˆåç«‹å³æ¸…ç†å¼‚æ­¥å¤„ç†ç´ æï¼Œç®€åŒ–çŠ¶æ€ç®¡ç†

4. **æ•°æ®åˆ†ç¦»**ï¼š
   - `localMediaReferences` ä¸“é—¨å¤„ç†æœ¬åœ°åª’ä½“å¼•ç”¨
   - `asyncProcessingMediaReferences` ä¸“é—¨å¤„ç†å¼‚æ­¥å¤„ç†ç´ æå¼•ç”¨
   - é¿å…æ•°æ®æ··ä¹±å’ŒçŠ¶æ€å†²çª

**ä¸ºä»€ä¹ˆåœ¨ timeline.mediaItems ä¸­åŒæ—¶ä¿å­˜æœ¬åœ°å’Œå¼‚æ­¥å¤„ç†é¡¹ç›®ï¼Ÿ**

1. **ç»Ÿä¸€ç®¡ç†**ï¼š
   - åª’ä½“åº“éœ€è¦ç»Ÿä¸€æ˜¾ç¤ºæ‰€æœ‰åª’ä½“é¡¹ç›®
   - ä¾¿äºæœç´¢ã€æ’åºå’Œè¿‡æ»¤æ“ä½œ
   - ä¿æŒç°æœ‰çš„åª’ä½“ç®¡ç†é€»è¾‘

2. **å…³ç³»ç»´æŠ¤**ï¼š
   - æ—¶é—´è½´é¡¹ç›®é€šè¿‡ `mediaItemId` å¼•ç”¨åª’ä½“é¡¹ç›®
   - ç»Ÿä¸€å­˜å‚¨ä¾¿äºç»´æŠ¤å¼•ç”¨å…³ç³»
   - æ”¯æŒå¼‚æ­¥å¤„ç†ç´ æè½¬æ¢åçš„æ— ç¼åˆ‡æ¢

3. **çŠ¶æ€åŒæ­¥**ï¼š
   - å¼‚æ­¥å¤„ç†ç´ æçš„çŠ¶æ€å˜åŒ–éœ€è¦åŒæ­¥åˆ°æ—¶é—´è½´
   - ç»Ÿä¸€å­˜å‚¨ä¾¿äºçŠ¶æ€å¹¿æ’­å’Œæ›´æ–°
   - å‡å°‘æ•°æ®åŒæ­¥çš„å¤æ‚æ€§

**ç®€åŒ–çš„è½¬æ¢è®¾è®¡åŸç†**ï¼š

```typescript
// å¼‚æ­¥å¤„ç†ç´ æè½¬æ¢ï¼šç›´æ¥æ›¿æ¢ï¼Œä¸ä¿ç•™å…³è”
AsyncProcessingMediaItem {
  id: "async_123",
  isConverting: false // è½¬æ¢å®Œæˆåé‡ç½®ä¸ºfalse
}

// è½¬æ¢å®Œæˆåï¼š
// 1. åˆ›å»º LocalMediaItem (æ–°ID: "local_456")
// 2. åˆ›å»º LocalMediaReference
// 3. æ¸…ç† AsyncProcessingMediaItem å’Œ AsyncProcessingMediaReference
```

è¿™ç§è®¾è®¡çš„ä¼˜åŠ¿ï¼š
- **ç®€æ´æ˜äº†**ï¼šé¿å…å¤æ‚çš„å…³è”å…³ç³»
- **å†…å­˜é«˜æ•ˆ**ï¼šè½¬æ¢å®Œæˆåç«‹å³æ¸…ç†ï¼Œå‡å°‘å†…å­˜å ç”¨
- **çŠ¶æ€æ¸…æ™°**ï¼šåªæœ‰å¤„ç†ä¸­å’Œé”™è¯¯çŠ¶æ€çš„å¼‚æ­¥å¤„ç†ç´ æä¼šä¿ç•™
- **æ˜“äºç»´æŠ¤**ï¼šå‡å°‘æ•°æ®ä¸€è‡´æ€§é—®é¢˜

### 7. å®ç°è¦ç‚¹æ€»ç»“

#### 7.1 è®¾è®¡åŸåˆ™
1. **ç»§æ‰¿å…³ç³»æ¸…æ™°**ï¼šBaseMediaItem â†’ LocalMediaItem/AsyncProcessingMediaItem
2. **ç±»å‹å®‰å…¨**ï¼šä½¿ç”¨TypeScriptç±»å‹å®ˆå«ç¡®ä¿ç±»å‹å®‰å…¨
3. **çŠ¶æ€åˆ†ç¦»**ï¼šè¿è¡Œæ—¶çŠ¶æ€ä¸æŒä¹…åŒ–çŠ¶æ€åˆ†ç¦»
4. **æ— ç¼è½¬æ¢**ï¼šå¼‚æ­¥å¤„ç†å®Œæˆåè‡ªåŠ¨è½¬æ¢ä¸ºæœ¬åœ°ç´ æ
5. **ç®€æ´é”™è¯¯å¤„ç†**ï¼šè½¬æ¢å¤±è´¥çš„åª’ä½“é¡¹ä»¥é”™è¯¯çŠ¶æ€ä¿ç•™åœ¨åª’ä½“åº“æˆ–è‡ªç„¶æ¶ˆå¤±

#### 7.2 å…³é”®æŠ€æœ¯ç‚¹
1. **å ä½ç¬¦æœºåˆ¶**ï¼šAsyncProcessingTimelineItemä½œä¸ºæ—¶é—´è½´å ä½ç¬¦
2. **è¿›åº¦åŒæ­¥**ï¼šå®æ—¶åŒæ­¥å¤„ç†è¿›åº¦åˆ°UI
3. **ç±»å‹æ£€æµ‹**ï¼šå¤„ç†å®Œæˆåè‡ªåŠ¨æ£€æµ‹æ–‡ä»¶ç±»å‹
4. **è½¨é“é‡åˆ†é…**ï¼šæ ¹æ®å®é™…ç±»å‹é‡æ–°åˆ†é…è½¨é“
5. **æ—¶é•¿è°ƒæ•´**ï¼šæ ¹æ®å®é™…æ–‡ä»¶æ—¶é•¿è°ƒæ•´clipèŒƒå›´

#### 7.3 ç”¨æˆ·ä½“éªŒä¼˜åŒ–
1. **è§†è§‰åé¦ˆ**ï¼šä¸åŒçŠ¶æ€çš„è§†è§‰åŒºåˆ†ï¼ˆé¢œè‰²ã€å›¾æ ‡ã€åŠ¨ç”»ï¼‰
2. **æ“ä½œé™åˆ¶**ï¼šå¼‚æ­¥å¤„ç†clipç¦ç”¨ç¼–è¾‘åŠŸèƒ½
3. **é”™è¯¯æç¤º**ï¼šæ¸…æ™°çš„é”™è¯¯ä¿¡æ¯æ˜¾ç¤º
4. **çŠ¶æ€æŒä¹…åŒ–**ï¼šé¡¹ç›®é‡æ–°æ‰“å¼€æ—¶ä¿æŒå¤„ç†çŠ¶æ€

#### 7.4 æ€§èƒ½è€ƒè™‘
1. **å†…å­˜ç®¡ç†**ï¼šè½¬æ¢å®Œæˆåç«‹å³æ¸…ç†å¼‚æ­¥å¤„ç†æ•°æ®
2. **å¹¶å‘æ§åˆ¶**ï¼šåˆç†æ§åˆ¶åŒæ—¶å¤„ç†çš„ä»»åŠ¡æ•°é‡
3. **è¿›åº¦ä¼˜åŒ–**ï¼šé¿å…è¿‡äºé¢‘ç¹çš„è¿›åº¦æ›´æ–°
4. **èµ„æºé‡Šæ”¾**ï¼šåŠæ—¶é‡Šæ”¾å–æ¶ˆçš„å¤„ç†ä»»åŠ¡èµ„æº

## æ€»ç»“

æœ¬æ–¹æ¡ˆé€šè¿‡ç»§æ‰¿å…³ç³»é‡æ–°è®¾è®¡äº†å¼‚æ­¥å¤„ç†ç´ ææ”¯æŒæ¶æ„ï¼Œ**ä¸åœ¨ MediaType ä¸­æ·»åŠ ç‰¹æ®Šå¤„ç†ç±»å‹**ï¼Œè€Œæ˜¯ä½¿ç”¨æ ‡è¯†å­—æ®µå’ŒçŠ¶æ€ç®¡ç†æ¥åŒºåˆ†å¼‚æ­¥å¤„ç†ç´ æã€‚è¿™ç§è®¾è®¡è§£å†³äº†åŸè®¾è®¡ä¸­çš„å­˜å‚¨æ··ä¹±ã€ç±»å‹å¤æ‚æ€§å’Œè½¬æ¢æµç¨‹é—®é¢˜ï¼Œä¿æŒäº†ä¸ç°æœ‰ç³»ç»Ÿçš„ä¸€è‡´æ€§ã€‚

### ä¸»è¦ç‰¹ç‚¹

1. **ç»Ÿä¸€çš„æ•°æ®æ¨¡å‹**ï¼šé€šè¿‡ç»§æ‰¿å…³ç³»ç»Ÿä¸€ç®¡ç†æœ¬åœ°å’Œå¼‚æ­¥å¤„ç†ç´ æ
2. **å®Œå–„çš„çŠ¶æ€ç®¡ç†**ï¼šæ¸…æ™°çš„çŠ¶æ€æµè½¬å’Œé”™è¯¯å¤„ç†æœºåˆ¶
3. **ä¼˜ç§€çš„ç”¨æˆ·ä½“éªŒ**ï¼šç›´è§‚çš„è§†è§‰åé¦ˆå’Œæ“ä½œæµç¨‹
4. **å¯æ‰©å±•çš„æ¶æ„**ï¼šæ”¯æŒå¤šç§å¼‚æ­¥å¤„ç†ç±»å‹çš„æ‰©å±•
5. **é€‚åˆç½‘é¡µåº”ç”¨**ï¼šè€ƒè™‘äº†ç½‘é¡µåº”ç”¨çš„ç‰¹æ®Šæ€§å’Œé™åˆ¶
6. **ç±»å‹ç³»ç»Ÿç®€æ´**ï¼šä¿æŒæ ¸å¿ƒMediaTypeçš„ç®€æ´æ€§ï¼Œé¿å…ç±»å‹ç³»ç»Ÿå¤æ‚åŒ–
7. **å†…å­˜é«˜æ•ˆ**ï¼šè½¬æ¢å®Œæˆåç«‹å³æ¸…ç†ï¼Œå‡å°‘å†…å­˜å ç”¨


### æŠ€æœ¯åˆ›æ–°

- **ç»§æ‰¿å…³ç³»è®¾è®¡**ï¼šæ¸…æ™°çš„ç±»å‹å±‚æ¬¡ç»“æ„ï¼Œä¾¿äºæ‰©å±•å’Œç»´æŠ¤
- **å ä½ç¬¦æœºåˆ¶**ï¼šAsyncProcessingTimelineItem ä½œä¸ºæ—¶é—´è½´å ä½ç¬¦ï¼Œæ”¯æŒå®æ—¶çŠ¶æ€æ›´æ–°
- **å¯æ’æ‹”å¤„ç†å™¨**ï¼šç»Ÿä¸€çš„å¤„ç†å™¨æ¥å£ï¼Œæ”¯æŒå¤šç§å¼‚æ­¥å¤„ç†ç±»å‹
- **æ™ºèƒ½è½¬æ¢æµç¨‹**ï¼šè‡ªåŠ¨æ£€æµ‹æ–‡ä»¶ç±»å‹ï¼Œæ™ºèƒ½å¤„ç†æ—¶é•¿è°ƒæ•´å’Œè½¨é“åˆ†é…
- **ç®€æ´çš„é”™è¯¯å¤„ç†**ï¼šæ¸…æ™°çš„é”™è¯¯çŠ¶æ€æ˜¾ç¤ºå’Œå¤„ç†æœºåˆ¶

è¯¥è®¾è®¡æ–¹æ¡ˆä¸ºè§†é¢‘ç¼–è¾‘å™¨çš„å¼‚æ­¥å¤„ç†åŠŸèƒ½æä¾›äº†åšå®çš„æŠ€æœ¯åŸºç¡€ï¼Œèƒ½å¤Ÿæ»¡è¶³å„ç§å¤æ‚çš„å¼‚æ­¥å¤„ç†éœ€æ±‚ï¼ŒåŒæ—¶ä¿æŒäº†ç³»ç»Ÿçš„ç®€æ´æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

## ğŸ“Š å®é™…å®æ–½æƒ…å†µæ€»ç»“ï¼ˆ2024å¹´æ›´æ–°ï¼‰

### ğŸ¯ å·²å®Œæˆçš„æ ¸å¿ƒåŠŸèƒ½
1. **å®Œæ•´çš„å¼‚æ­¥å¤„ç†UIç³»ç»Ÿ**ï¼šåª’ä½“åº“"å¤„ç†ä¸­"tabã€è¿œç¨‹ä¸‹è½½å¯¹è¯æ¡†ã€æ—¶é—´è½´å¼‚æ­¥å¤„ç†ç»„ä»¶
2. **ç½‘ç»œä¸‹è½½å¤„ç†å™¨**ï¼šæ”¯æŒè¿›åº¦æ˜¾ç¤ºã€å–æ¶ˆæ“ä½œã€é”™è¯¯å¤„ç†çš„å®Œæ•´ä¸‹è½½ç³»ç»Ÿ
3. **çŠ¶æ€ç®¡ç†ç³»ç»Ÿ**ï¼šå¼‚æ­¥å¤„ç†ç´ æçš„å®Œæ•´çŠ¶æ€ç®¡ç†å’Œå®æ—¶åŒæ­¥
4. **æ—¶é—´è½´é›†æˆ**ï¼šå¼‚æ­¥å¤„ç†å ä½ç¬¦åœ¨æ—¶é—´è½´ä¸­çš„å®Œæ•´æ˜¾ç¤ºå’Œäº¤äº’
5. **é”™è¯¯çŠ¶æ€æŒä¹…åŒ–**ï¼šå¯¼å…¥å¤±è´¥åª’ä½“é¡¹çš„æŒä¹…åŒ–å’Œæ¢å¤æœºåˆ¶

### ğŸ”§ æŠ€æœ¯æ¶æ„å®Œæ•´æ€§
- âœ… **ç±»å‹ç³»ç»Ÿ**ï¼šå®Œæ•´çš„TypeScriptç±»å‹å®šä¹‰å’Œç±»å‹å®ˆå«
- âœ… **ç»„ä»¶ç³»ç»Ÿ**ï¼šUIç»„ä»¶å®Œæ•´å®ç°ï¼ŒåŒ…æ‹¬å¯¹è¯æ¡†ã€åª’ä½“åº“ã€æ—¶é—´è½´ç»„ä»¶
- âœ… **å¤„ç†å™¨æ¶æ„**ï¼šå¯æ‰©å±•çš„å¼‚æ­¥å¤„ç†å™¨æ¥å£å’Œç®¡ç†ç³»ç»Ÿ
- âœ… **çŠ¶æ€ç®¡ç†**ï¼šPinia storeä¸­çš„å®Œæ•´çŠ¶æ€ç®¡ç†
- ğŸŸ¡ **æŒä¹…åŒ–æ¡†æ¶**ï¼šåŸºç¡€æ¡†æ¶å­˜åœ¨ï¼Œå¾…å®Œå–„å…·ä½“é€»è¾‘

### âš ï¸ å…³é”®ç¼ºå¤±ç¯èŠ‚
**Phase 5 è½¬æ¢å’Œé‡å»ºæœºåˆ¶**æ˜¯å½“å‰æœ€å…³é”®çš„ç¼ºå¤±ï¼ŒåŒ…æ‹¬ï¼š
1. æ–‡ä»¶ç±»å‹æ£€æµ‹å’Œæ”¯æŒæ£€æŸ¥
2. å¼‚æ­¥å¤„ç†å®Œæˆåçš„ç´ æè½¬æ¢æµç¨‹
3. æ—¶é—´è½´clipçš„æ— ç¼è½¬æ¢æœºåˆ¶
4. æ—¶é•¿è°ƒæ•´å’Œè½¨é“é‡åˆ†é…é€»è¾‘

### ğŸš€ å®æ–½å»ºè®®
1. **ä¼˜å…ˆå®ç°è½¬æ¢æœºåˆ¶**ï¼šè¿™æ˜¯è¿æ¥å¼‚æ­¥å¤„ç†å’Œæœ¬åœ°ç´ æçš„å…³é”®ç¯èŠ‚
2. **å®Œå–„æŒä¹…åŒ–æ”¯æŒ**ï¼šå®ç°é¡¹ç›®ä¿å­˜/åŠ è½½æ—¶çš„å¼‚æ­¥å¤„ç†ç´ æå¤„ç†
3. **ç«¯åˆ°ç«¯æµ‹è¯•**ï¼šç¡®ä¿æ•´ä¸ªå¼‚æ­¥å¤„ç†æµç¨‹çš„ç¨³å®šæ€§

**å½“å‰çŠ¶æ€**ï¼šå¼‚æ­¥å¤„ç†åŠŸèƒ½çš„UIå±‚å’Œç®¡ç†å±‚å·²åŸºæœ¬å®Œæˆï¼Œä¸»è¦ç¼ºå°‘è½¬æ¢å±‚çš„å®ç°ã€‚ä¸€æ—¦å®ç°è½¬æ¢æœºåˆ¶ï¼Œæ•´ä¸ªå¼‚æ­¥å¤„ç†åŠŸèƒ½å°†å®Œå…¨å¯ç”¨ã€‚

### 8. Tab åˆ‡æ¢é€»è¾‘æ‰©å±•

#### 8.1 è‡ªåŠ¨åˆ‡æ¢è§„åˆ™
```typescript
function determineTargetTab(draggedMediaTypes: MediaType[]): TabType {
  const hasAsyncProcessing = draggedMediaTypes.includes('unknown')
  const hasVideo = draggedMediaTypes.some(type => ['video', 'image'].includes(type))
  const hasAudio = draggedMediaTypes.includes('audio')

  // çº¯å¼‚æ­¥å¤„ç†ç´ æ
  if (hasAsyncProcessing && draggedMediaTypes.length === 1) {
    return 'processing'
  }

  // æ··åˆç±»å‹æ˜¾ç¤ºå…¨éƒ¨
  if (draggedMediaTypes.length > 1) {
    return 'all'
  }

  // å•ä¸€ç±»å‹
  if (hasVideo) return 'video'
  if (hasAudio) return 'audio'

  return 'all'
}
```

### 9. æ—¶é•¿è°ƒæ•´æœºåˆ¶

#### 9.1 æ—¶é•¿ä¸åŒ¹é…å¤„ç†
å½“å¼‚æ­¥å¤„ç†ç´ æå®Œæˆåï¼Œå®é™…æ–‡ä»¶æ—¶é•¿å¾€å¾€ä¸ç”¨æˆ·é¢„ä¼°çš„æ—¶é•¿ä¸ç¬¦ï¼š

```typescript
// æ—¶é•¿è°ƒæ•´é€»è¾‘ - æ ¹æ®å®é™…åª’ä½“ç±»å‹åˆ›å»ºæ­£ç¡®çš„æ—¶é—´èŒƒå›´
function adjustTimelineItemDuration(
  originalTimeRange: BaseTimeRange, // ä½¿ç”¨åŸºç¡€æ—¶é—´èŒƒå›´æ¥å£
  actualDuration: number,
  expectedDuration: number,
  actualMediaType: 'video' | 'image' | 'audio'
): VideoTimeRange | ImageTimeRange {
  const startTime = originalTimeRange.timelineStartTime

  if (actualDuration !== expectedDuration) {
    console.log(`â±ï¸ æ—¶é•¿è°ƒæ•´: é¢„ä¼°${expectedDuration}å¸§ â†’ å®é™…${actualDuration}å¸§`)
  }

  // æ ¹æ®å®é™…åª’ä½“ç±»å‹åˆ›å»ºå¯¹åº”çš„æ—¶é—´èŒƒå›´
  if (actualMediaType === 'video' || actualMediaType === 'audio') {
    return {
      clipStartTime: 0,
      clipEndTime: actualDuration,
      timelineStartTime: startTime,
      timelineEndTime: startTime + actualDuration,
      effectiveDuration: actualDuration,
      playbackRate: 1.0
    } as VideoTimeRange
  } else {
    // å›¾ç‰‡ç±»å‹
    return {
      timelineStartTime: startTime,
      timelineEndTime: startTime + actualDuration,
      displayDuration: actualDuration
    } as ImageTimeRange
  }
}
```

#### 9.2 ç”¨æˆ·ä½“éªŒè€ƒè™‘
- **ä¿æŒèµ·å§‹ä½ç½®**ï¼šclipçš„å¼€å§‹æ—¶é—´ä¿æŒä¸å˜ï¼Œåªè°ƒæ•´ç»“æŸæ—¶é—´
- **è‡ªåŠ¨é€‚åº”**ï¼šæ— éœ€ç”¨æˆ·æ‰‹åŠ¨è°ƒæ•´ï¼Œç³»ç»Ÿè‡ªåŠ¨ä½¿ç”¨å®é™…æ—¶é•¿
- **è§†è§‰åé¦ˆ**ï¼šåœ¨æ§åˆ¶å°æ˜¾ç¤ºæ—¶é•¿è°ƒæ•´ä¿¡æ¯ï¼Œä¾¿äºè°ƒè¯•
- **å†²çªå¤„ç†**ï¼šå¦‚æœè°ƒæ•´åçš„clipä¸å…¶ä»–clipé‡å ï¼Œéœ€è¦å¤„ç†å†²çª

### 10. é”™è¯¯å¤„ç†å’Œç”¨æˆ·ä½“éªŒ

#### 10.1 åŠ è½½çŠ¶æ€æ˜¾ç¤º
- **å¤„ç†ä¸­tab**ï¼š
  - `processing`ï¼šæ˜¾ç¤ºè“è‰²åŠ è½½è¿›åº¦æ¡å’Œç™¾åˆ†æ¯”
  - `unsupported`ï¼šæ˜¾ç¤ºçº¢è‰²é”™è¯¯å›¾æ ‡å’Œ"ä¸æ”¯æŒçš„æ ¼å¼"æ–‡å­—
  - `error`ï¼šæ˜¾ç¤ºçº¢è‰²é”™è¯¯å›¾æ ‡å’Œå…·ä½“é”™è¯¯ä¿¡æ¯
- **AsyncProcessingTimelineItem**ï¼š
  - `processing`ï¼šè“è‰²èƒŒæ™¯ï¼Œæ˜¾ç¤ºåŠ è½½åŠ¨ç”»å’Œè¿›åº¦ç™¾åˆ†æ¯”
  - `unsupported`ï¼šçº¢è‰²èƒŒæ™¯ï¼Œä¸­å¤®æ˜¾ç¤º"é”™è¯¯"æ–‡å­—
  - `error`ï¼šçº¢è‰²èƒŒæ™¯ï¼Œä¸­å¤®æ˜¾ç¤º"é”™è¯¯"æ–‡å­—
- **å±æ€§é¢æ¿**ï¼š
  - `processing`ï¼šæ˜¾ç¤ºå¤„ç†ç±»å‹ã€è¿›åº¦ã€é¢„è®¡æ—¶é•¿ã€å–æ¶ˆæŒ‰é’®
  - `unsupported`ï¼šæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€æ”¯æŒæ ¼å¼åˆ—è¡¨ã€é‡æ–°é€‰æ‹©/åˆ é™¤æŒ‰é’®
  - `error`ï¼šæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€åˆ é™¤æŒ‰é’®

#### 10.2 é”™è¯¯å¤„ç†ç­–ç•¥
- **ç½‘ç»œè¶…æ—¶**ï¼šæ˜¾ç¤ºé”™è¯¯çŠ¶æ€ï¼Œç”¨æˆ·å¯åˆ é™¤é‡æ–°æ·»åŠ 
- **URLæ— æ•ˆ**ï¼šæ˜¾ç¤ºé”™è¯¯æç¤ºï¼Œç”¨æˆ·å¯åˆ é™¤é‡æ–°æ·»åŠ 
- **æ–‡ä»¶æ ¼å¼ä¸æ”¯æŒ**ï¼š
  - å¤„ç†ä¸­tabä¸­æ˜¾ç¤ºçº¢è‰²é”™è¯¯çŠ¶æ€
  - æ—¶é—´è½´å ä½ç¬¦æ˜¾ç¤ºçº¢è‰²"é”™è¯¯"æ ‡è¯†
  - å±æ€§é¢æ¿æ˜¾ç¤º"ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹"å’Œæ”¯æŒæ ¼å¼åˆ—è¡¨
  - æä¾›"åˆ é™¤"é€‰é¡¹
- **å¤„ç†å¤±è´¥**ï¼šæ˜¾ç¤ºå…·ä½“é”™è¯¯ä¿¡æ¯ï¼Œæä¾›åˆ é™¤é€‰é¡¹

#### 10.3 çŠ¶æ€æŒä¹…åŒ–æœºåˆ¶
- **é¡¹ç›®é‡æ–°æ‰“å¼€**ï¼šä¿æŒå¼‚æ­¥å¤„ç†ä»»åŠ¡çš„çŠ¶æ€
- **çŠ¶æ€ä¿å­˜**ï¼šä¿å­˜å¤„ç†çŠ¶æ€åˆ°é¡¹ç›®é…ç½®
- **æ¸…ç†æœºåˆ¶**ï¼šå®šæœŸæ¸…ç†é•¿æ—¶é—´å¤±è´¥çš„å¼‚æ­¥å¤„ç†å ä½ç¬¦

## ç®€åŒ–å®æ–½è®¡åˆ’ï¼ˆä¸“æ³¨ç½‘ç»œä¸‹è½½ï¼‰

åŸºäºç”¨æˆ·éœ€æ±‚ï¼Œé‡æ–°æ•´ç†å®æ–½è®¡åˆ’ï¼Œæš‚æ—¶åªå®ç°ç½‘ç»œä¸‹è½½å¤„ç†å™¨ï¼Œå…¶ä»–å¤„ç†å™¨ç±»å‹æš‚ä¸å®ç°ã€‚

### Phase 1: åŸºç¡€ç±»å‹æ‰©å±•ï¼ˆ1å¤©ï¼‰âœ… **å·²å®Œæˆ**
- [x] æ‰©å±• `types/index.ts` æ·»åŠ å¼‚æ­¥å¤„ç†ç›¸å…³ç±»å‹å®šä¹‰
  - [x] `AsyncProcessingStatus` çŠ¶æ€æšä¸¾
  - [x] `AsyncProcessingType` ç±»å‹æšä¸¾ï¼ˆä»…åŒ…å« 'remote-download'ï¼‰
  - [x] `AsyncProcessingMediaItem` æ¥å£ï¼ˆç»§æ‰¿ `BaseMediaItem`ï¼‰
  - [x] `AsyncProcessingTimelineItem` æ¥å£ï¼ˆç»§æ‰¿ `BaseTimelineItem`ï¼‰
  - [x] `RemoteDownloadConfig` é…ç½®æ¥å£
  - [x] ç±»å‹å®ˆå«å‡½æ•°
- [x] æ‰©å±• `ProjectConfig` æ¥å£æ·»åŠ  `localMediaReferences` å’Œ `asyncProcessingMediaReferences` å­—æ®µ

### Phase 2: åª’ä½“åº“UIæ‰©å±•ï¼ˆ1å¤©ï¼‰âœ… **å·²å®Œæˆ**
- [x] åœ¨ `MediaLibrary.vue` ä¸­æ·»åŠ "å¤„ç†ä¸­"tab
- [x] æ‰©å±•å³é”®èœå•ï¼Œæ·»åŠ "è¿œç¨‹ä¸‹è½½"é€‰é¡¹
- [x] åˆ›å»º `RemoteDownloadDialog.vue` ç»„ä»¶
  - [x] URLè¾“å…¥æ¡†å’ŒéªŒè¯
  - [x] é¢„è®¡æ—¶é•¿è®¾ç½®ï¼ˆé»˜è®¤5ç§’ï¼‰
  - [x] è¾“å‡ºæ ¼å¼é€‰æ‹©ï¼ˆMP4, WebM, MP3, WAV, JPG, PNG, GIFï¼‰
  - [x] ç´ æåç§°è‡ªåŠ¨ç”Ÿæˆï¼ˆä»URLæå–ï¼‰
  - [x] ç¡®è®¤/å–æ¶ˆæŒ‰é’®
  - [x] ä¿®å¤æ ·å¼é—®é¢˜ï¼Œä½¿ç”¨æ­£ç¡®çš„CSSå˜é‡
- [x] åœ¨ Pinia store ä¸­æ·»åŠ å¼‚æ­¥å¤„ç†çŠ¶æ€ç®¡ç†
  - [x] `asyncProcessingItems` çŠ¶æ€æ•°ç»„
  - [x] æ·»åŠ /æ›´æ–°/åˆ é™¤å¼‚æ­¥å¤„ç†é¡¹ç›®çš„æ–¹æ³•
  - [x] è¿›åº¦æ›´æ–°å’ŒçŠ¶æ€å˜æ›´çš„å“åº”å¼å¤„ç†

#### Phase 2 å®ç°ç»†èŠ‚

**å·²å®ç°çš„åŠŸèƒ½**ï¼š
- åª’ä½“åº“"å¤„ç†ä¸­"tabï¼Œæ˜¾ç¤ºå¼‚æ­¥å¤„ç†é¡¹ç›®åˆ—è¡¨
- è¿›åº¦æ¡å’ŒçŠ¶æ€æŒ‡ç¤ºå™¨ï¼Œå®æ—¶æ˜¾ç¤ºå¤„ç†è¿›åº¦
- å–æ¶ˆå¤„ç†åŠŸèƒ½ï¼Œæ”¯æŒä¸­æ–­æ­£åœ¨è¿›è¡Œçš„å¼‚æ­¥å¤„ç†
- è¿œç¨‹ä¸‹è½½å¯¹è¯æ¡†ï¼Œæ”¯æŒURLè¾“å…¥ã€æ ¼å¼é€‰æ‹©ã€æ—¶é•¿è®¾ç½®
- å®Œæ•´çš„çŠ¶æ€ç®¡ç†ï¼ŒåŒ…æ‹¬é”™è¯¯å¤„ç†å’ŒçŠ¶æ€æ˜¾ç¤º

### Phase 3: ç½‘ç»œä¸‹è½½å¤„ç†å™¨ï¼ˆ1-2å¤©ï¼‰âœ… **å·²å®Œæˆ**
- [x] åˆ›å»º `utils/AsyncProcessingManager.ts`
  - [x] `AsyncProcessor` æ¥å£å®šä¹‰
  - [x] `AsyncProcessingManager` æ ¸å¿ƒç±»
  - [x] å¤„ç†å™¨æ³¨å†Œå’Œç®¡ç†æœºåˆ¶
  - [x] å®æ—¶çŠ¶æ€æ›´æ–°å›è°ƒæœºåˆ¶
- [x] å®ç° `RemoteDownloadProcessor.ts`
  - [x] ç½‘ç»œä¸‹è½½é€»è¾‘ï¼ˆfetch API + è¿›åº¦å›è°ƒï¼‰
  - [x] é”™è¯¯å¤„ç†ï¼ˆç½‘ç»œè¶…æ—¶ã€URLæ— æ•ˆç­‰ï¼‰
  - [x] å–æ¶ˆä¸‹è½½æ”¯æŒï¼ˆAbortControllerï¼‰
  - [x] æ–‡ä»¶åæå–é€»è¾‘ï¼ˆæ”¯æŒä¸­æ–‡æ–‡ä»¶åï¼‰
- [x] é›†æˆåˆ°åª’ä½“åº“UI
  - [x] æ›¿æ¢å ä½ç¬¦ä»£ç ä¸ºå®é™…ä¸‹è½½é€»è¾‘
  - [x] å®æ—¶çŠ¶æ€åŒæ­¥å’Œè¿›åº¦æ›´æ–°
  - [x] å¼‚æ­¥å¤„ç†ç´ æè½¬æ¢ä¸ºæ™®é€šç´ æ
- [x] UIä¼˜åŒ–å’Œé—®é¢˜ä¿®å¤
  - [x] å¼‚æ­¥å¤„ç†é¡¹ç›®ä¸“ç”¨æ˜¾ç¤ºå¸ƒå±€
  - [x] è¿›åº¦åœ†ç¯å’Œç™¾åˆ†æ¯”æ˜¾ç¤º
  - [x] å®¹å™¨é«˜åº¦é€‚é…å’Œå“åº”å¼æ›´æ–°
  - [x] ä¸­æ–‡æ–‡ä»¶åç¼–ç æ”¯æŒ
- [x] åç«¯æµ‹è¯•æ”¯æŒ
  - [x] ç½‘é€Ÿé™åˆ¶åŠŸèƒ½ï¼ˆæ”¯æŒåŠ¨æ€è°ƒæ•´ï¼‰
  - [x] æµå¼å“åº”å’Œä¸­æ–‡æ–‡ä»¶åæ”¯æŒ

#### Phase 3 å®ç°ç»†èŠ‚

**æ ¸å¿ƒæ¶æ„**ï¼š
- `AsyncProcessingManager` å•ä¾‹æ¨¡å¼ç®¡ç†æ‰€æœ‰å¼‚æ­¥å¤„ç†ä»»åŠ¡
- `AsyncProcessor` æ¥å£å®šä¹‰ç»Ÿä¸€çš„å¤„ç†å™¨è§„èŒƒ
- `RemoteDownloadProcessor` å®ç°ç½‘ç»œä¸‹è½½åŠŸèƒ½
- çŠ¶æ€æ›´æ–°å›è°ƒæœºåˆ¶ç¡®ä¿UIå®æ—¶å“åº”

**å…³é”®åŠŸèƒ½**ï¼š
1. **ç½‘ç»œä¸‹è½½**ï¼š
   - ä½¿ç”¨ fetch API è¿›è¡Œæµå¼ä¸‹è½½
   - æ”¯æŒè¿›åº¦å›è°ƒå’Œå–æ¶ˆæ“ä½œï¼ˆAbortControllerï¼‰
   - æ™ºèƒ½æ–‡ä»¶åæå–ï¼ˆä»URLè·¯å¾„æˆ–Content-Dispositionå¤´ï¼‰
   - å®Œå–„çš„é”™è¯¯å¤„ç†å’Œè¶…æ—¶æœºåˆ¶

2. **çŠ¶æ€ç®¡ç†**ï¼š
   - å¼‚æ­¥å¤„ç†ç´ æä¸æœ¬åœ°ç´ æåˆ†ç¦»ç®¡ç†
   - å®æ—¶çŠ¶æ€åŒæ­¥ï¼ˆpending â†’ processing â†’ completed/errorï¼‰
   - Vueå“åº”å¼æ›´æ–°ä¼˜åŒ–ï¼ˆå¯¹è±¡å‰¯æœ¬ä¼ é€’ï¼‰

3. **UIæ˜¾ç¤º**ï¼š
   - ä¸“ç”¨çš„å¼‚æ­¥å¤„ç†æ˜¾ç¤ºå¸ƒå±€ï¼ˆ50pxé«˜åº¦é€‚é…ï¼‰
   - 40pxè¿›åº¦åœ†ç¯ï¼Œç™½è‰²ç™¾åˆ†æ¯”æ–‡å­—
   - çŠ¶æ€å›¾æ ‡å’Œé¢œè‰²åŒºåˆ†ï¼ˆæ©™è‰²ç­‰å¾…ã€è“è‰²å¤„ç†ã€ç»¿è‰²å®Œæˆã€çº¢è‰²å¤±è´¥ï¼‰
   - Tooltipæ˜¾ç¤ºè¯¦ç»†çŠ¶æ€ä¿¡æ¯

4. **æ–‡ä»¶å¤„ç†**ï¼š
   - æ”¯æŒä¸­æ–‡æ–‡ä»¶åçš„URLç¼–ç /è§£ç 
   - è‡ªåŠ¨åª’ä½“ç±»å‹æ£€æµ‹
   - å¤„ç†å®Œæˆåè‡ªåŠ¨è½¬æ¢ä¸ºæ™®é€šç´ æ
   - **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**ï¼šå…ˆç§»é™¤å¼‚æ­¥å¤„ç†é¡¹å†æ·»åŠ æœ¬åœ°ç´ æï¼Œé¿å…åŒæ—¶æ˜¾ç¤ºä¸¤ä¸ªåª’ä½“é¡¹

**æµ‹è¯•æ”¯æŒ**ï¼š
- åç«¯ç½‘é€Ÿé™åˆ¶åŠŸèƒ½ï¼ˆé»˜è®¤1MB/sï¼Œå¯åŠ¨æ€è°ƒæ•´0.1-100MB/sï¼‰
- æµå¼å“åº”æ¨¡æ‹ŸçœŸå®ç½‘ç»œç¯å¢ƒ
- ä¸­æ–‡æ–‡ä»¶åæ”¯æŒæµ‹è¯•

### Phase 3.5: é”™è¯¯çŠ¶æ€åª’ä½“é¡¹æŒä¹…åŒ–ï¼ˆ0.5å¤©ï¼‰âœ… **å·²å®Œæˆ**
- [x] æ‰©å±•ç±»å‹å®šä¹‰æ”¯æŒé”™è¯¯çŠ¶æ€
  - [x] æ‰©å±• `LocalMediaReference` æ¥å£æ·»åŠ é”™è¯¯çŠ¶æ€å­—æ®µ
  - [x] æ–°å¢ `MediaErrorType` æšä¸¾å®šä¹‰ä¸‰ç§é”™è¯¯ç±»å‹
  - [x] å‘åå…¼å®¹ç°æœ‰æ•°æ®ç»“æ„ï¼ˆstatusé»˜è®¤ä¸ºnormalï¼‰
- [x] å¢å¼ºMediaLibrary.vueé”™è¯¯å¤„ç†é€»è¾‘
  - [x] åˆ›å»º `saveErrorMediaReference` è¾…åŠ©å‡½æ•°
  - [x] åœ¨ `addVideoItem`ã€`addImageItem`ã€`addAudioItem` çš„catchå—ä¸­ä¿å­˜é”™è¯¯å¼•ç”¨
  - [x] æ”¯æŒä¸‰ç§é”™è¯¯ç±»å‹ï¼šwebavè§£æé”™è¯¯ã€æ–‡ä»¶åŠ è½½é”™è¯¯ã€ä¸æ”¯æŒæ ¼å¼
  - [x] ä¿ç•™åŸå§‹æ–‡ä»¶ä¿¡æ¯ç”¨äºæœªæ¥é‡è¯•åŠŸèƒ½
- [x] æ‰©å±•MediaManager.tsåŠŸèƒ½
  - [x] æ–°å¢ `saveErrorMediaReference` æ–¹æ³•åˆ›å»ºé”™è¯¯çŠ¶æ€åª’ä½“å¼•ç”¨
  - [x] æ–°å¢ `restoreErrorMediaItem` æ–¹æ³•æ¢å¤é”™è¯¯çŠ¶æ€åª’ä½“é¡¹
  - [x] æ‰©å±• `loadAllMediaForProject` æ–¹æ³•æ”¯æŒé”™è¯¯çŠ¶æ€åª’ä½“é¡¹åŠ è½½
  - [x] æ–‡ä»¶åŠ è½½å¤±è´¥æ—¶è‡ªåŠ¨è½¬æ¢ä¸ºé”™è¯¯çŠ¶æ€
- [x] éªŒè¯é¡¹ç›®ä¿å­˜/åŠ è½½æµç¨‹
  - [x] ç¡®è®¤ `projectModule.ts` æ­£ç¡®ä¿å­˜æ‰€æœ‰åª’ä½“å¼•ç”¨ï¼ˆåŒ…æ‹¬é”™è¯¯çŠ¶æ€ï¼‰
  - [x] ç¡®è®¤ `ProjectManager.loadProjectContent` ä½¿ç”¨æ‰©å±•åçš„åŠ è½½æ–¹æ³•
  - [x] é”™è¯¯çŠ¶æ€åª’ä½“å¼•ç”¨ä¸æ­£å¸¸å¼•ç”¨ç»Ÿä¸€ç®¡ç†

**Phase 3.5 å®ç°æ•ˆæœ**ï¼š
- âœ… å¯¼å…¥å¤±è´¥çš„åª’ä½“æ–‡ä»¶ä¸å†æ¶ˆå¤±ï¼Œä¿ç•™åœ¨ç´ æåŒºæ˜¾ç¤ºçº¢è‰²é”™è¯¯çŠ¶æ€
- âœ… é¡¹ç›®ä¿å­˜æ—¶é”™è¯¯çŠ¶æ€åª’ä½“é¡¹ä¿¡æ¯è¢«å®Œæ•´ä¿å­˜åˆ°é¡¹ç›®é…ç½®æ–‡ä»¶
- âœ… é¡¹ç›®é‡æ–°æ‰“å¼€æ—¶é”™è¯¯çŠ¶æ€åª’ä½“é¡¹è¢«æ­£ç¡®æ¢å¤ï¼Œç”¨æˆ·å¯ä»¥çœ‹åˆ°ä¹‹å‰å¯¼å…¥å¤±è´¥çš„æ–‡ä»¶
- âœ… æ–‡ä»¶åŠ è½½å¤±è´¥æ—¶ï¼ˆå¦‚æ–‡ä»¶è¢«åˆ é™¤ï¼‰è‡ªåŠ¨è½¬æ¢ä¸ºé”™è¯¯çŠ¶æ€ï¼Œä¸å½±å“é¡¹ç›®ä½¿ç”¨
- âœ… ä¸ºæœªæ¥çš„é‡è¯•ã€åˆ é™¤ã€æ ¼å¼è½¬æ¢ç­‰åŠŸèƒ½å¥ å®šäº†æ•°æ®åŸºç¡€

### Phase 4: å¼‚æ­¥å¤„ç†æ—¶é—´è½´ç»„ä»¶ï¼ˆ1å¤©ï¼‰âœ… **å·²å®Œæˆ**
- [x] åˆ›å»º `TimelineAsyncProcessingClip.vue` ç»„ä»¶
  - [x] æ ¹æ® `processingStatus` æ˜¾ç¤ºä¸åŒçŠ¶æ€
    - [x] `pending`: æ©™è‰²èƒŒæ™¯ï¼Œç­‰å¾…å›¾æ ‡
    - [x] `processing`: è“è‰²èƒŒæ™¯ï¼Œè¿›åº¦æ¡å’Œç™¾åˆ†æ¯”
    - [x] `error`: çº¢è‰²èƒŒæ™¯ï¼Œé”™è¯¯å›¾æ ‡
    - [x] `unsupported`: çº¢è‰²èƒŒæ™¯ï¼Œ"ä¸æ”¯æŒ"æ–‡å­—
  - [x] ç¦ç”¨ç¼–è¾‘åŠŸèƒ½ï¼ˆè£å‰ªã€å¤åˆ¶ã€åˆ†å‰²ç­‰ï¼‰
  - [x] æ”¯æŒåŸºæœ¬æ“ä½œï¼ˆé€‰ä¸­ã€åˆ é™¤ã€æ‹–æ‹½ï¼‰
- [x] åœ¨ `Timeline.vue` ä¸­é›†æˆå¼‚æ­¥å¤„ç†clipæ¸²æŸ“
- [x] å®æ—¶çŠ¶æ€åŒæ­¥æœºåˆ¶ï¼Œæ—¶é—´è½´ç»„ä»¶è‡ªåŠ¨å“åº”ç´ æåŒºçŠ¶æ€å˜åŒ–
- [x] å®Œæ•´çš„è§†è§‰çŠ¶æ€ç³»ç»Ÿå’Œè¿›åº¦æ˜¾ç¤º

### ğŸ¯ Phase 4 å®Œæˆè¯¦æƒ…
**å·²å®ç°çš„æ ¸å¿ƒåŠŸèƒ½**ï¼š
- âœ… TimelineAsyncProcessingClip.vue å¼‚æ­¥å¤„ç†æ—¶é—´è½´ç»„ä»¶ï¼Œæ”¯æŒå®Œæ•´çš„çŠ¶æ€æ˜¾ç¤º
- âœ… Timeline.vue é›†æˆå¼‚æ­¥å¤„ç†clipæ¸²æŸ“é€»è¾‘ï¼Œæ”¯æŒç±»å‹å®‰å…¨çš„ç»„ä»¶é€‰æ‹©
- âœ… å®æ—¶çŠ¶æ€åŒæ­¥æœºåˆ¶ï¼Œæ—¶é—´è½´ç»„ä»¶è‡ªåŠ¨å“åº”ç´ æåŒºçŠ¶æ€å˜åŒ–
- âœ… å®Œæ•´çš„è§†è§‰çŠ¶æ€ç³»ç»Ÿï¼Œä¸åŒå¤„ç†çŠ¶æ€æœ‰æ¸…æ™°çš„é¢œè‰²å’Œå›¾æ ‡åŒºåˆ†
- âœ… è¿›åº¦æ˜¾ç¤ºç³»ç»Ÿï¼Œæ”¯æŒ40pxè¿›åº¦åœ†ç¯å’Œç™¾åˆ†æ¯”æ–‡å­—æ˜¾ç¤º

**æŠ€æœ¯å®ç°**ï¼š
- âœ… `TimelineAsyncProcessingClip.vue` - ä¸“ç”¨çš„å¼‚æ­¥å¤„ç†æ—¶é—´è½´clipç»„ä»¶
- âœ… `Timeline.vue` - æ‰©å±•æ”¯æŒå¼‚æ­¥å¤„ç†clipçš„æ¸²æŸ“å’Œäº¤äº’
- âœ… `mediaModule.ts` - å¼‚æ­¥å¤„ç†ç´ æçŠ¶æ€ç®¡ç†å’Œå®æ—¶æ›´æ–°
- âœ… ç±»å‹å®ˆå«å‡½æ•° `isAsyncProcessingTimelineItem` ç¡®ä¿ç±»å‹å®‰å…¨

**UI/UXç‰¹æ€§**ï¼š
- âœ… çŠ¶æ€æŒ‡ç¤ºå™¨ï¼špending(æ©™è‰²ç­‰å¾…)ã€processing(è“è‰²è¿›åº¦)ã€error(çº¢è‰²é”™è¯¯)ã€unsupported(çº¢è‰²ä¸æ”¯æŒ)
- âœ… å¤„ç†ç±»å‹å›¾æ ‡ï¼šè¿œç¨‹ä¸‹è½½æ˜¾ç¤ºåœ°çƒå›¾æ ‡ï¼Œæ¸…æ™°æ ‡è¯†å¤„ç†ç±»å‹
- âœ… è¿›åº¦åœ†ç¯ï¼š32px SVGåœ†ç¯ï¼Œç™½è‰²ç™¾åˆ†æ¯”æ–‡å­—ï¼Œå®æ—¶æ˜¾ç¤ºä¸‹è½½è¿›åº¦
- âœ… ç¦ç”¨ç¼–è¾‘åŠŸèƒ½ï¼šå¼‚æ­¥å¤„ç†clipä¸æ”¯æŒè£å‰ªã€å¤åˆ¶ã€åˆ†å‰²ç­‰ç¼–è¾‘æ“ä½œ
- âœ… åŸºæœ¬æ“ä½œæ”¯æŒï¼šé€‰ä¸­ã€åˆ é™¤ã€æ‹–æ‹½ç§»åŠ¨ç­‰åŸºç¡€æ—¶é—´è½´æ“ä½œ
- âœ… å®æ—¶çŠ¶æ€åŒæ­¥ï¼šé€šè¿‡ `currentAsyncItem` è®¡ç®—å±æ€§å®æ—¶è·å–ç´ æåŒºæœ€æ–°çŠ¶æ€
- âœ… Tooltipæç¤ºï¼šæ˜¾ç¤ºè¯¦ç»†çš„å¤„ç†ä¿¡æ¯å’ŒçŠ¶æ€è¯´æ˜

**çŠ¶æ€ç®¡ç†ä¼˜åŒ–**ï¼š
- âœ… å®æ—¶çŠ¶æ€è®¡ç®—ï¼šæ—¶é—´è½´ç»„ä»¶é€šè¿‡ `videoStore.getAsyncProcessingItem()` å®æ—¶è·å–çŠ¶æ€
- âœ… å“åº”å¼æ›´æ–°ï¼šçŠ¶æ€å˜åŒ–è‡ªåŠ¨è§¦å‘UIæ›´æ–°ï¼Œæ— éœ€æ‰‹åŠ¨åŒæ­¥
- âœ… é»˜è®¤å€¼å¤„ç†ï¼šæä¾›åˆç†çš„é»˜è®¤å€¼ï¼Œé¿å…çŠ¶æ€ç¼ºå¤±æ—¶çš„æ˜¾ç¤ºé—®é¢˜
- âœ… ç±»å‹å®‰å…¨ï¼šä½¿ç”¨TypeScriptç±»å‹å®ˆå«ç¡®ä¿ç»„ä»¶ç±»å‹æ­£ç¡®æ€§

### Phase 5: è½¬æ¢å’Œé‡å»ºæœºåˆ¶ï¼ˆ1-2å¤©ï¼‰ğŸŸ¡ **è®¾è®¡å®Œæˆï¼Œå¾…å®ç°**
**æ ¸å¿ƒè®¾è®¡**ï¼šé€šè¿‡éšè—å¼‚æ­¥ç´ æè€Œéåˆ é™¤æ¥è§£å†³WebAVè§£ææœŸé—´çš„æ—¶é—´è½´clipä¸¢å¤±é—®é¢˜

- [x] è®¾è®¡ä¼˜åŒ–çš„è½¬æ¢æµç¨‹ï¼ˆéšè— â†’ ç­‰å¾…è§£æ â†’ ä¿å­˜ä¿¡æ¯ â†’ é‡å»ºclipï¼‰
- [ ] æ‰©å±• `AsyncProcessingMediaItem` ç±»å‹æ·»åŠ  `isConverting` å­—æ®µ
- [ ] å®ç°åª’ä½“åº“UIè¿‡æ»¤é€»è¾‘ï¼ˆéšè— `isConverting: true` çš„é¡¹ç›®ï¼‰
- [ ] å®ç°æ–‡ä»¶ç±»å‹æ£€æµ‹é€»è¾‘
  - [ ] `isSupportedMediaType()` å‡½æ•°åŸºäºMIMEç±»å‹æ£€æµ‹
  - [ ] é›†æˆåˆ° `AsyncProcessingManager.detectMediaType()` æ–¹æ³•
- [ ] å®ç°ä¼˜åŒ–çš„è½¬æ¢æµç¨‹
  - [ ] éšè—å¼‚æ­¥ç´ æï¼š`asyncProcessingItem.isConverting = true`
  - [ ] ç­‰å¾…æœ¬åœ°ç´ æè§£æï¼š`waitForMediaItemReady()` å‡½æ•°
  - [ ] ä¿å­˜æ—¶é—´è½´clipä¿¡æ¯ï¼šä½ç½®ã€æ—¶é•¿ã€è½¨é“ã€é…ç½®ç­‰
  - [ ] é‡å»ºæ—¶é—´è½´clipï¼šåŸºäºä¿å­˜ä¿¡æ¯åˆ›å»ºæ–°çš„ `LocalTimelineItem`
  - [ ] æ—¶é•¿è°ƒæ•´æœºåˆ¶ï¼ˆå®é™…æ—¶é•¿ vs é¢„ä¼°æ—¶é•¿ï¼‰
  - [ ] è½¨é“å…¼å®¹æ€§æ£€æŸ¥å’Œé‡æ–°åˆ†é…é€»è¾‘
- [ ] é”™è¯¯çŠ¶æ€å¤„ç†å’Œæ¢å¤
  - [ ] è½¬æ¢å¤±è´¥æ—¶é‡æ–°æ˜¾ç¤ºå¼‚æ­¥ç´ æï¼ˆ`isConverting = false`ï¼‰
  - [ ] ä¸æ”¯æŒæ–‡ä»¶ç±»å‹çš„é”™è¯¯æ˜¾ç¤º
  - [ ] å®Œæ•´çš„é”™è¯¯æ¢å¤æœºåˆ¶

### Phase 6: æŒä¹…åŒ–æ”¯æŒï¼ˆ1å¤©ï¼‰ğŸŸ¡ **éƒ¨åˆ†å®ç°**
- [x] æ‰©å±• `ProjectConfig` æ¥å£æ·»åŠ  `asyncProcessingMediaReferences` å­—æ®µ
- [x] `ProjectManager.ts` ä¸­é¡¹ç›®åˆ›å»ºæ¨¡æ¿åŒ…å«å¼‚æ­¥å¤„ç†å­—æ®µ
- [x] `projectModule.ts` ä¸­é¡¹ç›®ä¿å­˜åŒ…å«åŸºç¡€æ¡†æ¶ï¼ˆå½“å‰è®¾ä¸ºç©ºå¯¹è±¡ï¼‰
- [ ] å®Œæ•´çš„å¼‚æ­¥å¤„ç†ç´ æä¿å­˜é€»è¾‘å®ç°
- [ ] åŠ è½½æ—¶æ¢å¤å¼‚æ­¥å¤„ç†ç´ æï¼ˆé‡ç½®è¿è¡Œæ—¶çŠ¶æ€ï¼‰
- [ ] è‡ªåŠ¨é‡å¯æœªå®Œæˆçš„ä¸‹è½½ä»»åŠ¡
- [ ] æ‰©å±• `MediaManager.ts` æ”¯æŒå¼‚æ­¥å¤„ç†ç´ æå¼•ç”¨
- [ ] æ›´æ–°è‡ªåŠ¨ä¿å­˜é€»è¾‘åŒ…å«å¼‚æ­¥å¤„ç†ç´ æ

### Phase 7: é›†æˆå’Œæµ‹è¯•ï¼ˆ1å¤©ï¼‰âŒ **å¾…å®ç°**
- [ ] åœ¨ `videoStore` ä¸­é›†æˆå¼‚æ­¥å¤„ç†ç´ æç®¡ç†
- [ ] ç«¯åˆ°ç«¯æµ‹è¯•ç½‘ç»œä¸‹è½½æµç¨‹
- [ ] é”™è¯¯åœºæ™¯æµ‹è¯•ï¼ˆç½‘ç»œä¸­æ–­ã€æ— æ•ˆURLã€ä¸æ”¯æŒæ ¼å¼ï¼‰
- [ ] UIäº¤äº’æµ‹è¯•ï¼ˆæ‹–æ‹½ã€åˆ é™¤ã€çŠ¶æ€æ˜¾ç¤ºï¼‰
- [ ] é¡¹ç›®ä¿å­˜/åŠ è½½æµ‹è¯•

## å®ç°é‡ç‚¹

### 1. ç®€åŒ–çš„ç±»å‹ç³»ç»Ÿ
```typescript
// åªå®ç°ç½‘ç»œä¸‹è½½ç›¸å…³çš„ç±»å‹
export type AsyncProcessingType = 'remote-download' // æš‚æ—¶åªæœ‰è¿™ä¸€ç§
export type AsyncProcessingStatus = 'pending' | 'processing' | 'completed' | 'error' | 'unsupported'

// ç®€åŒ–çš„é…ç½®ç±»å‹
export interface RemoteDownloadConfig {
  type: 'remote-download'
  url: string
  timeout?: number
}
```

### 2. æ ¸å¿ƒUIæ‰©å±•
- åœ¨åª’ä½“åº“æ·»åŠ "å¤„ç†ä¸­"tab
- åœ¨å³é”®èœå•æ·»åŠ "è¿œç¨‹ä¸‹è½½"é€‰é¡¹
- åˆ›å»ºURLè¾“å…¥å¯¹è¯æ¡†

### 3. æ ¸å¿ƒä¸‹è½½é€»è¾‘
```typescript
export class RemoteDownloadProcessor implements AsyncProcessor {
  async process(config: RemoteDownloadConfig, onProgress: (progress: number) => void): Promise<File> {
    // ä½¿ç”¨ fetch API ä¸‹è½½æ–‡ä»¶
    // å®æ—¶æ›´æ–°è¿›åº¦
    // å¤„ç†é”™è¯¯å’Œå–æ¶ˆ
  }
}
```

### 4. ç®€åŒ–çš„è½¬æ¢æµç¨‹
- ä¸‹è½½å®Œæˆåæ£€æµ‹æ–‡ä»¶ç±»å‹
- å¦‚æœæ”¯æŒï¼šè½¬æ¢ä¸ºæ™®é€š MediaItem
- å¦‚æœä¸æ”¯æŒï¼šä¿æŒé”™è¯¯çŠ¶æ€ï¼Œæ˜¾ç¤ºçº¢è‰²é”™è¯¯

### 5. åŸºç¡€çš„æŒä¹…åŒ–
- åªä¿å­˜ä¸‹è½½é…ç½®å’Œé”™è¯¯çŠ¶æ€
- ä¸ä¿å­˜è¿›åº¦ç­‰è¿è¡Œæ—¶çŠ¶æ€
- é‡æ–°æ‰“å¼€é¡¹ç›®æ—¶è‡ªåŠ¨é‡å¯ä¸‹è½½

## é¢„æœŸæ•ˆæœ

å®ç°åç”¨æˆ·å¯ä»¥ï¼š

### å¼‚æ­¥å¤„ç†åŠŸèƒ½ï¼ˆPhase 1-3ï¼‰
1. å³é”®ç‚¹å‡»åª’ä½“åº“ç©ºç™½åŒºåŸŸ â†’ é€‰æ‹©"è¿œç¨‹ä¸‹è½½"
2. è¾“å…¥URLå’Œé¢„è®¡æ—¶é•¿ â†’ ç¡®è®¤å¼€å§‹ä¸‹è½½
3. åœ¨"å¤„ç†ä¸­"tabçœ‹åˆ°ä¸‹è½½è¿›åº¦
4. æ‹–æ‹½åˆ°æ—¶é—´è½´æ˜¾ç¤ºå ä½ç¬¦
5. ä¸‹è½½å®Œæˆåè‡ªåŠ¨è½¬æ¢ä¸ºæ™®é€šç´ æ
6. å¦‚æœæ ¼å¼ä¸æ”¯æŒï¼Œæ˜¾ç¤ºé”™è¯¯çŠ¶æ€

### é”™è¯¯çŠ¶æ€åª’ä½“é¡¹æŒä¹…åŒ–åŠŸèƒ½ï¼ˆPhase 3.5ï¼‰
7. **å¯¼å…¥å¤±è´¥æŒä¹…åŒ–**ï¼šå¯¼å…¥æŸåæˆ–ä¸æ”¯æŒçš„åª’ä½“æ–‡ä»¶æ—¶ï¼Œç´ æåŒºæ˜¾ç¤ºçº¢è‰²é”™è¯¯çŠ¶æ€å›¾æ ‡ï¼Œä¸ä¼šæ¶ˆå¤±
8. **é¡¹ç›®ä¿å­˜æ¢å¤**ï¼šä¿å­˜é¡¹ç›®åé‡æ–°æ‰“å¼€ï¼Œé”™è¯¯çŠ¶æ€çš„åª’ä½“é¡¹è¢«æ­£ç¡®æ¢å¤ï¼Œç”¨æˆ·å¯ä»¥çœ‹åˆ°ä¹‹å‰å¯¼å…¥å¤±è´¥çš„æ–‡ä»¶
9. **æ–‡ä»¶ä¸¢å¤±æ£€æµ‹**ï¼šé¡¹ç›®åŠ è½½æ—¶å¦‚æœåª’ä½“æ–‡ä»¶è¢«åˆ é™¤æˆ–ç§»åŠ¨ï¼Œè‡ªåŠ¨è½¬æ¢ä¸ºé”™è¯¯çŠ¶æ€æ˜¾ç¤º
10. **é”™è¯¯ä¿¡æ¯è®°å½•**ï¼šè¯¦ç»†è®°å½•é”™è¯¯ç±»å‹ï¼ˆWebAVè§£æé”™è¯¯ã€æ–‡ä»¶åŠ è½½é”™è¯¯ã€ä¸æ”¯æŒæ ¼å¼ï¼‰å’Œé”™è¯¯ä¿¡æ¯
11. **æ•°æ®å®Œæ•´æ€§**ï¼šä¿ç•™åŸå§‹æ–‡ä»¶ä¿¡æ¯ï¼ˆæ–‡ä»¶åã€å¤§å°ã€ç±»å‹ã€ä¿®æ”¹æ—¶é—´ï¼‰ï¼Œä¸ºæœªæ¥é‡è¯•åŠŸèƒ½å¥ å®šåŸºç¡€
12. **ç»Ÿä¸€ç®¡ç†**ï¼šé”™è¯¯çŠ¶æ€åª’ä½“é¡¹ä¸æ­£å¸¸åª’ä½“é¡¹ä½¿ç”¨ç»Ÿä¸€çš„å¼•ç”¨ç®¡ç†æœºåˆ¶ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§

## æŠ€æœ¯é£é™©æ§åˆ¶

1. **ç½‘ç»œä¸‹è½½é£é™©**ï¼š
   - ä½¿ç”¨ AbortController æ”¯æŒå–æ¶ˆ
   - è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´
   - å¤„ç† CORS é™åˆ¶æç¤º

2. **æ–‡ä»¶ç±»å‹é£é™©**ï¼š
   - ä¸¥æ ¼çš„æ–‡ä»¶ç±»å‹æ£€æµ‹
   - æ¸…æ™°çš„é”™è¯¯æç¤º
   - æ”¯æŒé‡æ–°é€‰æ‹©æˆ–åˆ é™¤

3. **æ€§èƒ½é£é™©**ï¼š
   - é™åˆ¶åŒæ—¶ä¸‹è½½æ•°é‡
   - å¤§æ–‡ä»¶ä¸‹è½½è¿›åº¦ä¼˜åŒ–
   - å†…å­˜ä½¿ç”¨ç›‘æ§

4. **ç”¨æˆ·ä½“éªŒé£é™©**ï¼š
   - æ¸…æ™°çš„çŠ¶æ€åé¦ˆ
   - åˆç†çš„é”™è¯¯æç¤º
   - ç®€å•çš„æ“ä½œæµç¨‹

## æ”¯æŒçš„å¤„ç†ç±»å‹å’Œæ ¼å¼

### è¿œç¨‹ä¸‹è½½æ”¯æŒ
- **åè®®**ï¼šHTTP, HTTPS
- **æ ¼å¼**ï¼šæ‰€æœ‰WebAVæ”¯æŒçš„æ ¼å¼
- **ç‰¹æ€§**ï¼šè¿›åº¦æ˜¾ç¤ºã€æ–­ç‚¹ç»­ä¼ ã€è¶…æ—¶å¤„ç†

### æ ¼å¼è½¬æ¢æ”¯æŒ
- **è¾“å…¥æ ¼å¼**ï¼šAVI, MOV, MKV, FLVç­‰å¸¸è§æ ¼å¼
- **è¾“å‡ºæ ¼å¼**ï¼šMP4, WebMï¼ˆåŸºäºWebAVæ”¯æŒï¼‰
- **ç‰¹æ€§**ï¼šè´¨é‡è°ƒæ•´ã€åˆ†è¾¨ç‡ç¼©æ”¾ã€ç¼–ç å‚æ•°é…ç½®

### æ–‡ä»¶å‹ç¼©æ”¯æŒ
- **å‹ç¼©ç®—æ³•**ï¼šH.264, H.265, VP9ç­‰
- **å‹ç¼©çº§åˆ«**ï¼š0-100å¯è°ƒ
- **ç‰¹æ€§**ï¼šæ–‡ä»¶å¤§å°é™åˆ¶ã€è´¨é‡ä¿æŒ

### AIå¢å¼ºæ”¯æŒ
- **è¶…åˆ†è¾¨ç‡**ï¼šè§†é¢‘/å›¾ç‰‡åˆ†è¾¨ç‡æå‡
- **é™å™ª**ï¼šéŸ³é¢‘/è§†é¢‘å™ªå£°å»é™¤
- **ç¨³å®š**ï¼šè§†é¢‘é˜²æŠ–å¤„ç†
- **ä¸Šè‰²**ï¼šé»‘ç™½è§†é¢‘/å›¾ç‰‡ä¸Šè‰²

### å†…å®¹ç”Ÿæˆæ”¯æŒ
- **èƒŒæ™¯éŸ³ä¹**ï¼šAIç”ŸæˆéŸ³ä¹
- **å­—å¹•**ï¼šè‡ªåŠ¨è¯­éŸ³è¯†åˆ«å’Œå­—å¹•ç”Ÿæˆ
- **é…éŸ³**ï¼šæ–‡æœ¬è½¬è¯­éŸ³
- **ç‰¹æ•ˆ**ï¼šAIç”Ÿæˆè§†è§‰ç‰¹æ•ˆ

### æ‰¹é‡å¯¼å…¥æ”¯æŒ
- **æ–‡ä»¶ç±»å‹**ï¼šæ··åˆåª’ä½“æ–‡ä»¶
- **å¤„ç†é€‰é¡¹**ï¼šè‡ªåŠ¨å‹ç¼©ã€æ ¼å¼è½¬æ¢ã€ç¼©ç•¥å›¾ç”Ÿæˆ
- **ç‰¹æ€§**ï¼šå¹¶å‘å¤„ç†ã€è¿›åº¦ç»Ÿè®¡

### æ ¼å¼æ£€æµ‹
```typescript
function isSupportedMediaType(file: File): boolean {
  // å¤ç”¨ç°æœ‰çš„åª’ä½“ç±»å‹æ£€æµ‹é€»è¾‘
  return isVideoFile(file) || isAudioFile(file) || isImageFile(file)
}

function canProcessWithType(file: File, processingType: AsyncProcessingType): boolean {
  // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å¯ä»¥ç”¨æŒ‡å®šçš„å¤„ç†ç±»å‹å¤„ç†
  switch (processingType) {
    case 'format-conversion':
      return isConvertibleFormat(file)
    case 'file-compression':
      return isCompressibleFormat(file)
    case 'ai-enhancement':
      return isEnhanceable(file)
    default:
      return true
  }
}
```

## æŠ€æœ¯é£é™©å’Œæ³¨æ„äº‹é¡¹

### è¿œç¨‹ä¸‹è½½ç›¸å…³é£é™©
1. **CORS é™åˆ¶**ï¼šæŸäº›è¿œç¨‹èµ„æºå¯èƒ½å­˜åœ¨è·¨åŸŸé™åˆ¶
2. **è¿æ¥ç¨³å®šæ€§**ï¼šéœ€è¦å¤„ç†è¿æ¥ä¸­æ–­å’Œé‡è¿
3. **ä¸‹è½½é€Ÿåº¦**ï¼šå¤§æ–‡ä»¶ä¸‹è½½å¯èƒ½å½±å“ç”¨æˆ·ä½“éªŒ

### å¤„ç†æ€§èƒ½é£é™©
1. **CPU å¯†é›†å‹**ï¼šæ ¼å¼è½¬æ¢å’ŒAIå¤„ç†æ¶ˆè€—å¤§é‡CPUèµ„æº
2. **å†…å­˜å ç”¨**ï¼šå¤§æ–‡ä»¶å¤„ç†å¯èƒ½å¯¼è‡´å†…å­˜ä¸è¶³
3. **å¹¶å‘é™åˆ¶**ï¼šåŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡å¯èƒ½å½±å“ç³»ç»Ÿæ€§èƒ½

### æ–‡ä»¶å¤„ç†é£é™©
1. **æ–‡ä»¶ç±»å‹æ£€æµ‹**ï¼šéœ€è¦å‡†ç¡®æ£€æµ‹æ–‡ä»¶ç±»å‹ï¼Œé¿å…è¯¯åˆ¤
2. **æ ¼å¼å…¼å®¹æ€§**ï¼šæŸäº›æ ¼å¼å¯èƒ½ä¸æ”¯æŒè½¬æ¢æˆ–å¤„ç†
3. **æ–‡ä»¶æŸå**ï¼šå¤„ç†è¿‡ç¨‹ä¸­å¯èƒ½å¯¼è‡´æ–‡ä»¶æŸå

### ç”¨æˆ·ä½“éªŒé£é™©
1. **å¤„ç†æ—¶é—´**ï¼šé•¿æ—¶é—´å¤„ç†å¯èƒ½å½±å“ç”¨æˆ·ä½“éªŒ
2. **é”™è¯¯çŠ¶æ€ç®¡ç†**ï¼šç¡®ä¿ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹èƒ½æ­£ç¡®æ˜¾ç¤ºé”™è¯¯çŠ¶æ€
3. **å­˜å‚¨ç©ºé—´**ï¼šå¤„ç†åçš„æ–‡ä»¶å ç”¨æœ¬åœ°å­˜å‚¨ç©ºé—´

### å®‰å…¨é£é™©
1. **æ¶æ„æ–‡ä»¶**ï¼šè¿œç¨‹ä¸‹è½½çš„æ–‡ä»¶å¯èƒ½åŒ…å«æ¶æ„å†…å®¹
2. **éšç§æ³„éœ²**ï¼šAIå¤„ç†å¯èƒ½æ¶‰åŠæ•°æ®ä¸Šä¼ åˆ°ç¬¬ä¸‰æ–¹æœåŠ¡
3. **èµ„æºæ»¥ç”¨**ï¼šæ¶æ„ç”¨æˆ·å¯èƒ½æ»¥ç”¨å¤„ç†èµ„æº

## è®¾è®¡ç†å¿µè¯´æ˜

### ä¸ºä»€ä¹ˆä¸éœ€è¦å•ç‹¬çš„å¼‚æ­¥å¤„ç† MediaType

#### 1. å¼‚æ­¥å¤„ç†æ˜¯ä¸´æ—¶çŠ¶æ€ï¼Œä¸æ˜¯çœŸæ­£çš„åª’ä½“ç±»å‹
- å¼‚æ­¥å¤„ç†ç´ ææœ€ç»ˆä¼šè½¬æ¢ä¸º `video`ã€`audio`ã€`image` ç­‰å…·ä½“ç±»å‹
- å¤„ç†ç±»å‹ï¼ˆè¿œç¨‹ä¸‹è½½ã€æ ¼å¼è½¬æ¢ã€AIå¢å¼ºç­‰ï¼‰åªæ˜¯å¤„ç†è¿‡ç¨‹ä¸­çš„ä¸´æ—¶æ ‡è¯†
- å¤„ç†å®Œæˆåï¼Œå¼‚æ­¥å¤„ç†ç´ æä¼šè¢«å®Œå…¨æ¸…ç†ï¼Œä¸ä¿ç•™ä»»ä½•å¤„ç†ç›¸å…³ä¿¡æ¯

#### 2. é¿å…ç±»å‹ç³»ç»Ÿå¤æ‚åŒ–
- ä¿æŒ `MediaType = 'video' | 'image' | 'audio' | 'text'` çš„ç®€æ´æ€§
- ç±»å‹åˆ¤æ–­é€»è¾‘åŸºäºæ–°çš„ç»§æ‰¿å…³ç³»é‡æ„
- é¿å…åœ¨å„ç§å·¥å…·å‡½æ•°ä¸­æ·»åŠ å¯¹ç‰¹æ®Šå¤„ç†ç±»å‹çš„ç‰¹æ®Šå¤„ç†

#### 3. ä½¿ç”¨æ ‡è¯†å­—æ®µæ›´æ¸…æ™°
- `isAsyncProcessing: true` æ˜ç¡®æ ‡è¯†å¼‚æ­¥å¤„ç†ç´ æ
- `isAsyncProcessingPlaceholder: true` æ˜ç¡®æ ‡è¯†å¼‚æ­¥å¤„ç†æ—¶é—´è½´é¡¹ç›®
- ç±»å‹å®ˆå«å‡½æ•°åŸºäºæ ‡è¯†å­—æ®µè€Œä¸æ˜¯ mediaTypeï¼Œé€»è¾‘æ›´æ¸…æ™°

#### 4. æ›´å¥½çš„ç±»å‹å®‰å…¨å’Œæ‰©å±•æ€§
- å¼‚æ­¥å¤„ç†ç´ æå¤„ç†å‰ä½¿ç”¨ `mediaType: 'unknown'`
- å¤„ç†åä½¿ç”¨å®é™…æ£€æµ‹åˆ°çš„ç±»å‹ï¼ˆ`'video'`ã€`'audio'` ç­‰ï¼‰
- é€šè¿‡ `AsyncProcessingType` æšä¸¾æ”¯æŒå¤šç§å¤„ç†ç±»å‹
- æ˜“äºæ·»åŠ æ–°çš„å¤„ç†ç±»å‹è€Œä¸å½±å“æ ¸å¿ƒç±»å‹ç³»ç»Ÿ

#### 5. ç»Ÿä¸€çš„å¤„ç†æ¶æ„
- è¿œç¨‹ä¸‹è½½ã€æ ¼å¼è½¬æ¢ã€AIå¤„ç†ç­‰éƒ½ä½¿ç”¨ç›¸åŒçš„å¼‚æ­¥å¤„ç†æ¶æ„
- ç»Ÿä¸€çš„è¿›åº¦æ˜¾ç¤ºã€é”™è¯¯å¤„ç†ã€çŠ¶æ€ç®¡ç†
- å¯æ’æ‹”çš„å¤„ç†å™¨è®¾è®¡ï¼Œæ”¯æŒç¬¬ä¸‰æ–¹æ‰©å±•

## æ–°è®¾è®¡çš„æ ¸å¿ƒä¼˜åŠ¿

### 1. æ¸…æ™°çš„ç»§æ‰¿å…³ç³»
- **BaseMediaItem/BaseMediaReference**ï¼šæä¾›å…±åŒçš„åŸºç¡€å±æ€§
- **LocalMediaItem/LocalMediaReference**ï¼šä¸“é—¨å¤„ç†æœ¬åœ°æ–‡ä»¶
- **AsyncProcessingMediaItem/AsyncProcessingMediaReference**ï¼šä¸“é—¨å¤„ç†å¼‚æ­¥å¤„ç†ç´ æ
- **ç±»å‹å®‰å…¨**ï¼šé€šè¿‡ç»§æ‰¿å…³ç³»ç¡®ä¿ç±»å‹ä¸€è‡´æ€§ï¼Œå‡å°‘ç±»å‹åˆ¤æ–­çš„å¤æ‚åº¦

### 2. ç®€åŒ–çš„å­˜å‚¨ç­–ç•¥
- **å•ä¸€æ•°æ®æº**ï¼šæ‰€æœ‰åª’ä½“é¡¹ç›®éƒ½å­˜å‚¨åœ¨åŒä¸€ä¸ªæ•°ç»„ä¸­ï¼Œé€šè¿‡ç±»å‹åŒºåˆ†
- **å¼•ç”¨åˆ†ç¦»**ï¼šæœ¬åœ°å¼•ç”¨å’Œå¼‚æ­¥å¤„ç†å¼•ç”¨åˆ†åˆ«å­˜å‚¨ï¼Œé¿å…æ•°æ®æ··ä¹±
- **å³æ—¶æ¸…ç†**ï¼šè½¬æ¢å®Œæˆåç«‹å³æ¸…ç†å¼‚æ­¥å¤„ç†ç´ æï¼Œä¿æŒæ•°æ®ç®€æ´

### 3. ç®€åŒ–çš„è½¬æ¢æµç¨‹
- **ç›´æ¥æ›¿æ¢**ï¼šå¼‚æ­¥å¤„ç†ç´ æè½¬æ¢æ—¶åˆ›å»ºæ–°çš„æœ¬åœ°ç´ æï¼Œç„¶åæ¸…ç†å¼‚æ­¥å¤„ç†ç´ æ
- **ä¸€æ¬¡æ€§è½¬æ¢**ï¼šè½¬æ¢è¿‡ç¨‹æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œä¸ä¿ç•™ä¸­é—´çŠ¶æ€
- **å†…å­˜ä¼˜åŒ–**ï¼šè½¬æ¢å®Œæˆåç«‹å³é‡Šæ”¾å¼‚æ­¥å¤„ç†ç´ æå ç”¨çš„å†…å­˜

### 4. åŠŸèƒ½å®Œæ•´æ€§
- **å¼‚æ­¥åŠ è½½**ï¼šæ”¯æŒå ä½ç¬¦æœºåˆ¶ï¼Œä¸é˜»å¡ç”¨æˆ·æ“ä½œ
- **è‡ªåŠ¨è½¬æ¢**ï¼šåŠ è½½å®Œæˆåè‡ªåŠ¨è½¬æ¢ä¸ºå¯¹åº”çš„æœ¬åœ°åª’ä½“ç±»å‹
- **å®Œå…¨æœ¬åœ°åŒ–**ï¼šè½¬æ¢å®Œæˆåä¸ç›´æ¥å¯¼å…¥çš„æœ¬åœ°ç´ æå®Œå…¨ä¸€è‡´ï¼Œæ— å¼‚æ­¥å¤„ç†ä¾èµ–
- **ä¸“ç”¨ç»„ä»¶**ï¼šTimelineAsyncProcessingClip æä¾›ä¸“é—¨çš„å¼‚æ­¥å¤„ç†ç´ ææ¸²æŸ“å’Œäº¤äº’
- **æ™ºèƒ½é”™è¯¯å¤„ç†**ï¼šä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹ä¿æŒå ä½ç¬¦çŠ¶æ€ï¼Œæ˜¾ç¤ºæ¸…æ™°çš„é”™è¯¯åé¦ˆ
- **æŒä¹…åŒ–æ”¯æŒ**ï¼šå®Œæ•´çš„é¡¹ç›®ä¿å­˜å’ŒçŠ¶æ€ä¿æŒæœºåˆ¶ï¼ŒåŒ…æ‹¬é”™è¯¯çŠ¶æ€
- **é”™è¯¯çŠ¶æ€æŒä¹…åŒ–**ï¼šå¯¼å…¥å¤±è´¥çš„åª’ä½“é¡¹ä¸ä¼šæ¶ˆå¤±ï¼Œä¿ç•™åœ¨ç´ æåŒºå¹¶åœ¨é¡¹ç›®é‡æ–°æ‰“å¼€æ—¶æ­£ç¡®æ¢å¤
- **æ™ºèƒ½é”™è¯¯æ£€æµ‹**ï¼šæ–‡ä»¶åŠ è½½å¤±è´¥æ—¶è‡ªåŠ¨è½¬æ¢ä¸ºé”™è¯¯çŠ¶æ€ï¼Œä¿æŒé¡¹ç›®å®Œæ•´æ€§
- **è¯¦ç»†é”™è¯¯è®°å½•**ï¼šè®°å½•é”™è¯¯ç±»å‹ã€é”™è¯¯ä¿¡æ¯ã€æ—¶é—´æˆ³å’ŒåŸå§‹æ–‡ä»¶ä¿¡æ¯ï¼Œä¾¿äºé—®é¢˜è¯Šæ–­
- **ç»Ÿä¸€é”™è¯¯ç®¡ç†**ï¼šé”™è¯¯çŠ¶æ€åª’ä½“é¡¹ä¸æ­£å¸¸åª’ä½“é¡¹ä½¿ç”¨ç»Ÿä¸€çš„å¼•ç”¨ç®¡ç†æœºåˆ¶
- **ç®€æ´é”™è¯¯å¤„ç†**ï¼šæ¸…æ™°çš„é”™è¯¯çŠ¶æ€æ˜¾ç¤ºå’Œå¤„ç†æœºåˆ¶
- **ç”¨æˆ·ä½“éªŒ**ï¼šç›´è§‚çš„è¿›åº¦æ˜¾ç¤ºã€çŠ¶æ€åé¦ˆå’Œé”™è¯¯æç¤º
- **æ•°æ®ä¸€è‡´æ€§**ï¼šç¡®ä¿å¼‚æ­¥å¤„ç†ç´ æè½¬æ¢åçš„æ•°æ®ç»“æ„ä¸æœ¬åœ°ç´ æå®Œå…¨ç›¸åŒ
- **æ“ä½œçµæ´»æ€§**ï¼šæ”¯æŒåˆ é™¤é”™è¯¯çŠ¶æ€çš„å¤„ç†é¡¹
- **è§†è§‰ä¸€è‡´æ€§**ï¼šå¼‚æ­¥å¤„ç†clipä¸æ™®é€šclipåœ¨æ—¶é—´è½´ä¸Šæœ‰ç»Ÿä¸€çš„è§†è§‰é£æ ¼

### 5. æ¶æ„ä¼˜åŠ¿
- **å¯æ‰©å±•æ€§**ï¼šç»§æ‰¿å…³ç³»ä¾¿äºæœªæ¥æ·»åŠ æ–°çš„å¤„ç†ç±»å‹
- **å¯ç»´æŠ¤æ€§**ï¼šæ¸…æ™°çš„ç±»å‹å±‚æ¬¡å’Œç®€åŒ–çš„çŠ¶æ€ç®¡ç†é™ä½äº†ä»£ç å¤æ‚åº¦
- **å¯æµ‹è¯•æ€§**ï¼šç±»å‹åˆ†ç¦»ä½¿å¾—å•å…ƒæµ‹è¯•æ›´å®¹æ˜“ç¼–å†™
- **é«˜æ€§èƒ½**ï¼šåŠæ—¶æ¸…ç†å‡å°‘å†…å­˜å ç”¨ï¼Œæå‡åº”ç”¨æ€§èƒ½
- **æ’ä»¶åŒ–**ï¼šå¯æ’æ‹”çš„å¤„ç†å™¨è®¾è®¡ï¼Œæ”¯æŒç¬¬ä¸‰æ–¹æ‰©å±•
```
