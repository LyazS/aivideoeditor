# AI 视频编辑器 - 视频实时预览引擎

这是一个基于 Vue 3 + TypeScript + 组合式 API 的视频实时预览引擎，提供了完整的视频编辑界面。

## 功能特性

### 🎬 核心功能
- **视频预览窗口**: 实时播放当前时间轴位置的视频内容
- **时间轴管理**: 可视化的时间轴，支持拖拽视频片段
- **播放控制**: 完整的播放控制面板，包括播放/暂停、跳转、速度控制等
- **拖拽上传**: 支持直接拖拽视频文件到时间轴
- **🔍 时间轴缩放**: Alt + 鼠标滚轮缩放，最小可精确到每一帧
- **↔️ 水平滚动**: Shift + 鼠标滚轮水平滚动时间轴

### 🎯 主要组件

#### 1. VideoPreviewEngine.vue
主容器组件，整合所有子组件

#### 2. PreviewWindow.vue
- 视频预览窗口
- 支持多种视频格式 (MP4, WebM, AVI 等)
- 实时同步时间轴位置
- 显示当前播放时间

#### 3. Timeline.vue
- 时间轴容器
- 支持拖拽文件上传
- 视频片段管理
- 背景网格显示（自适应缩放级别）
- Alt + 滚轮缩放功能
- Shift + 滚轮水平滚动功能

#### 4. VideoClip.vue
- 可拖拽的视频片段
- 缩略图预览
- 右键菜单操作
- 片段信息显示

#### 5. TimeScale.vue
- 时间刻度标记（支持帧级精度显示）
- 播放头指示器
- 点击跳转功能
- Alt + 滚轮缩放功能
- Shift + 滚轮水平滚动功能

#### 6. PlaybackControls.vue
- 播放/暂停控制
- 时间跳转按钮
- 进度条拖拽
- 音量控制
- 播放速度调节

## 使用方法

### 1. 启动项目
```bash
cd frontend
npm install
npm run dev
```

### 2. 基本操作

#### 上传视频
1. 将视频文件拖拽到时间轴区域
2. 视频片段会自动添加到拖拽位置
3. 支持多个视频文件同时上传

#### 时间轴缩放和滚动
1. **缩放操作**：
   - 按住 Alt 键 + 鼠标滚轮上下滚动进行缩放
   - 向上滚动放大，向下滚动缩小
   - 最大可放大到帧级精度（30fps）

2. **水平滚动**：
   - 按住 Shift 键 + 鼠标滚轮上下滚动进行水平移动
   - 向上滚动向左移动，向下滚动向右移动
   - 在放大状态下浏览时间轴的不同部分

3. **精确编辑**：
   - 放大到最大级别可以看到每一帧
   - 时间刻度会显示帧数（MM:SS:FF格式）
   - 播放头自动对齐到帧边界，支持拖拽操作
   - 支持逐帧精确的剪切和调整

#### 连续播放体验
1. **智能播放**：
   - 时间指针持续移动，提供完整的时间轴预览
   - 自动在视频片段和空白区域间切换
   - 空白区域显示黑屏和时间指示器

2. **无缝切换**：
   - 进入视频片段时自动开始播放
   - 离开视频片段时自动显示黑屏
   - 支持跨片段的连续播放体验

#### 编辑视频片段
1. **拖拽移动**: 点击并拖拽视频片段到新位置
2. **删除片段**: 右键点击片段选择"删除"
3. **复制片段**: 右键点击片段选择"复制"

#### 播放控制
1. **播放/暂停**: 点击中央播放按钮
2. **时间跳转**: 点击时间轴任意位置
3. **快进/快退**: 使用前进/后退按钮（10秒间隔）
4. **速度控制**: 使用右侧速度选择器

### 3. 技术架构

#### 状态管理 (Pinia)
```typescript
interface VideoClip {
  id: string
  file: File
  url: string
  duration: number
  startTime: number
  endTime: number
  timelinePosition: number
  name: string
}
```

#### 核心功能
- **实时预览**: 根据时间轴位置自动切换视频片段
- **拖拽系统**: 原生 HTML5 拖拽 API
- **时间同步**: 视频播放与时间轴实时同步
- **响应式设计**: 适配不同屏幕尺寸

## 支持的视频格式

- MP4 (推荐)
- WebM
- AVI
- MOV
- 其他浏览器支持的视频格式

## 浏览器兼容性

- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

## 高级功能

### 🎯 可视化编辑
- **直接操作**: 在预览窗口中直接点击、拖拽、缩放视频片段
- **精确控制**: 支持像素级精确调整和键盘快捷键
- **实时预览**: 所有调整实时反映到预览窗口
- 详细使用方法请参考：[可视化编辑指南](VISUAL_EDITING_GUIDE.md)

### 🔄 连续播放
- **智能切换**: 自动在视频片段和空白区域间切换
- **时间轴驱动**: 时间指针持续移动，提供完整的预览体验
- **空白处理**: 没有视频的时间段显示黑屏和时间指示器

### ⚡ 性能优化
- **帧级精度**: 支持30fps的逐帧编辑
- **智能缓存**: 优化视频加载和播放性能
- **响应式设计**: 适配不同屏幕尺寸和分辨率

## 开发计划

### 即将实现的功能
- [ ] 视频片段裁剪和分割
- [ ] 音频轨道支持
- [ ] 转场效果和滤镜
- [ ] 视频导出功能
- [ ] 撤销/重做操作
- [ ] 更多键盘快捷键

### 技术优化
- [ ] 虚拟滚动优化大量片段性能
- [ ] Web Workers 处理视频解析
- [ ] 更精确的时间同步算法
- [ ] 多轨道编辑支持

## 项目结构

```
frontend/src/
├── components/
│   ├── VideoPreviewEngine.vue  # 主容器
│   ├── PreviewWindow.vue       # 预览窗口
│   ├── Timeline.vue            # 时间轴
│   ├── VideoClip.vue          # 视频片段
│   ├── TimeScale.vue          # 时间刻度
│   └── PlaybackControls.vue   # 播放控制
├── stores/
│   └── videostore.ts          # 视频状态管理
└── App.vue                    # 应用入口
```

## 📚 文档说明

- **README.md** - 项目主要说明文档（本文件）
- **VISUAL_EDITING_GUIDE.md** - 可视化编辑功能详细使用指南
- **frontend/README.md** - Vue 3 + Vite 项目的标准说明

## 贡献指南

1. Fork 项目
2. 创建功能分支
3. 提交更改
4. 推送到分支
5. 创建 Pull Request

## 许可证

MIT License
